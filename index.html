<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMAL EMPIRE | ELITE V6</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --bg: #040609; --card: #0d1117; --accent: #00ff59; --gold: #f5d033;
            --text: #ffffff; --text-dim: #8b949e; --border: #21262d; --red: #ff4747;
        }
        * { box-sizing: border-box; font-family: 'Plus Jakarta Sans', sans-serif; transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        body { background: var(--bg); color: var(--text); margin: 0; display: flex; height: 100vh; overflow: hidden; }

        /* --- SIDEBAR --- */
        .sidebar { width: 260px; background: var(--card); border-right: 1px solid var(--border); display: flex; flex-direction: column; z-index: 100; }
        .nav-item { padding: 15px 25px; cursor: pointer; color: var(--text-dim); display: flex; align-items: center; gap: 12px; font-weight: 600; border-left: 4px solid transparent; }
        .nav-item:hover, .nav-item.active { background: #161b22; color: var(--accent); border-left-color: var(--accent); }
        
        /* --- MAIN --- */
        .main { flex: 1; overflow-y: auto; padding: 30px; position: relative; background: radial-gradient(circle at 50% 0%, #1a2c38, #040609); }
        .view { display: none; animation: fadeIn 0.4s ease; max-width: 1200px; margin: 0 auto; }
        .view.active { display: block; }

        /* --- TRAGAMONEDAS PRO --- */
        .slot-machine-container { position: relative; display: flex; align-items: center; gap: 30px; background: #161a1f; padding: 40px; border-radius: 30px; border: 4px solid #2b2f36; box-shadow: 0 0 50px rgba(0,0,0,0.5); }
        .reels-container { display: flex; gap: 15px; background: #000; padding: 20px; border-radius: 15px; border: 2px solid var(--border); }
        .reel { width: 100px; height: 120px; background: #111; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 4rem; overflow: hidden; border: 1px solid #333; }
        .reel.spinning { animation: blurSpin 0.1s infinite linear; }
        @keyframes blurSpin { 0% { filter: blur(0); transform: translateY(0); } 50% { filter: blur(10px); } 100% { filter: blur(0); transform: translateY(5px); } }

        /* PALANCA */
        .lever-base { width: 20px; height: 150px; background: #2b2f36; border-radius: 10px; position: relative; cursor: pointer; }
        .lever-arm { width: 10px; height: 100px; background: #4a4e54; position: absolute; top: 0; left: 5px; border-radius: 5px; transform-origin: bottom; transition: 0.3s; }
        .lever-ball { width: 40px; height: 40px; background: var(--red); border-radius: 50%; position: absolute; top: -20px; left: -10px; box-shadow: 0 0 15px var(--red); }
        .lever-base.pulled .lever-arm { transform: rotateX(150deg); }

        /* --- PLINKO --- */
        .plinko-multipliers { display: flex; justify-content: space-around; width: 100%; margin-top: 20px; }
        .mult-box { width: 40px; height: 30px; border-radius: 5px; font-weight: 900; font-size: 0.7rem; display: flex; align-items: center; justify-content: center; }

        /* --- UI HELPERS --- */
        .btn { padding: 12px 25px; border: none; border-radius: 8px; font-weight: 800; cursor: pointer; text-transform: uppercase; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        .btn-accent { background: var(--accent); color: #000; }
        .btn-gold { background: var(--gold); color: #000; }
        .glass-card { background: rgba(13, 17, 23, 0.8); border: 1px solid var(--border); border-radius: 20px; padding: 25px; margin-bottom: 20px; }
    </style>
</head>
<body>

<div id="auth-overlay" style="position:fixed; inset:0; background:var(--bg); z-index:1000; display:flex; align-items:center; justify-content:center;">
    <div class="glass-card" style="width:380px; text-align:center; border-color:var(--accent);">
        <h1 style="font-family:'Orbitron'; color:var(--accent); letter-spacing:5px;">SMAL EMPIRE</h1>
        <input type="text" id="auth-u" placeholder="Nombre de Usuario">
        <button class="btn btn-accent" style="width:100%" onclick="login()">INGRESAR AL CASINO</button>
    </div>
</div>

<aside class="sidebar">
    <div style="padding:30px; text-align:center;">
        <div id="u-ava" style="width:65px; height:65px; background:var(--accent); color:black; border-radius:20px; display:flex; align-items:center; justify-content:center; margin:0 auto 15px; font-weight:900; font-size:1.8rem;">?</div>
        <h3 id="u-name" style="margin:0;">-</h3>
        <div style="color:var(--gold); font-weight:900; font-size:1.4rem; margin-top:10px;">ü™ô <span id="u-bal">0.00</span></div>
    </div>
    <nav>
        <div class="nav-item active" onclick="nav('home')">üè† Inicio</div>
        <div class="nav-item" onclick="nav('games')">üé∞ Juegos Elite</div>
        <div class="nav-item" onclick="nav('boxes')">üì¶ Mystery Boxes</div>
        <div class="nav-item" onclick="nav('shop')">üõí Tienda Oficial</div>
        <div class="nav-item" onclick="nav('trades')">ü§ù Tradeos Directos</div>
        <div class="nav-item" onclick="nav('market')">‚öñÔ∏è Mercado P2P</div>
        <div class="nav-item" onclick="nav('inv')">üéí Mi Mochila</div>
        <div class="nav-item" id="adm-btn" style="display:none; color:var(--gold)" onclick="nav('admin')">üõ† PANEL MAESTRO</div>
    </nav>
</aside>

<main class="main">
    <div id="v-home" class="view active">
        <h1 style="font-family:'Orbitron';">LOBBY DEL <span style="color:var(--accent)">IMPERIO</span></h1>
        <div class="glass-card" style="border-left: 5px solid var(--accent);">
            <h3>Noticias Globales</h3>
            <p>¬°El sistema de comercio ya est√° activo! Vende tus premios a otros jugadores.</p>
        </div>
    </div>

    <div id="v-games" class="view">
        <div id="game-selection" style="display:grid; grid-template-columns: repeat(3, 1fr); gap:20px;">
            <div class="glass-card" onclick="openG('SLOTS')" style="cursor:pointer; text-align:center;"><h2>üé∞ SLOTS FRUIT</h2><p>Jackpot 777</p></div>
            <div class="glass-card" onclick="openG('MINAS')" style="cursor:pointer; text-align:center;"><h2>üí£ MINAS</h2><p>Multiplicador x10</p></div>
            <div class="glass-card" onclick="openG('PLINKO')" style="cursor:pointer; text-align:center;"><h2>üîµ PLINKO</h2><p>Ca√≠da de suerte</p></div>
        </div>

        <div id="game-stage" style="display:none; text-align:center; padding-top:20px;">
            <div id="game-content"></div>
            <button class="btn btn-gold" style="margin-top:40px;" onclick="closeG()">VOLVER AL MEN√ö</button>
        </div>
    </div>

    <div id="v-market" class="view">
        <h1>MERCADO DE JUGADORES</h1>
        <div id="m-list" style="display:grid; grid-template-columns:repeat(auto-fill, minmax(250px, 1fr)); gap:15px;"></div>
    </div>

    <div id="v-admin" class="view">
        <h1 style="color:var(--gold)">CREADOR DE PREMIOS & CAJAS</h1>
        <div class="glass-card">
            <h3>Nueva Mystery Box</h3>
            <input type="text" id="adm-box-n" placeholder="Nombre de la Caja">
            <input type="number" id="adm-box-p" placeholder="Precio en Tokens">
            <p style="font-size:0.8rem; color:var(--text-dim);">Escribe 10 premios separados por coma:</p>
            <textarea id="adm-box-items" placeholder="iPhone, BMW, 100 Tokens, Skin Oro..." style="width:100%; background:#000; color:#fff; border:1px solid var(--border); border-radius:8px; padding:10px;"></textarea>
            <button class="btn btn-accent" style="margin-top:15px;" onclick="adminCreateBox()">PUBLICAR CAJA</button>
        </div>
    </div>

    <div id="v-inv" class="view">
        <h1>MI MOCHILA</h1>
        <div id="inv-list" style="display:grid; grid-template-columns:repeat(auto-fill, minmax(220px, 1fr)); gap:15px;"></div>
    </div>
</main>

<script>
    let db = JSON.parse(localStorage.getItem('smal_v6')) || {
        u: "", bal: 50, free: 3, inv: [], boxes: [], market: []
    };

    function save() { localStorage.setItem('smal_v6', JSON.stringify(db)); }

    function login() {
        let u = document.getElementById('auth-u').value;
        if(!u) return;
        db.u = u;
        if(u === "SmalAdmin") document.getElementById('adm-btn').style.display = 'flex';
        document.getElementById('auth-overlay').style.display = 'none';
        document.getElementById('u-name').innerText = u;
        document.getElementById('u-ava').innerText = u[0].toUpperCase();
        refresh();
    }

    function refresh() {
        document.getElementById('u-bal').innerText = db.bal.toFixed(2);
        renderInv();
        renderMarket();
        save();
    }

    function nav(id) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById('v-'+id).classList.add('active');
    }

    // --- JUEGOS: SLOTS ---
    function openG(g) {
        document.getElementById('game-selection').style.display = 'none';
        const stage = document.getElementById('game-stage');
        const cont = document.getElementById('game-content');
        stage.style.display = 'block';
        cont.innerHTML = "";

        if(g === 'SLOTS') {
            cont.innerHTML = `
                <div class="slot-machine-container">
                    <div class="reels-container">
                        <div class="reel" id="r1">üçé</div>
                        <div class="reel" id="r2">üçí</div>
                        <div class="reel" id="r3">üçè</div>
                    </div>
                    <div class="lever-base" id="lever" onclick="pullLever()">
                        <div class="lever-arm"></div>
                        <div class="lever-ball"></div>
                    </div>
                </div>
                <h2 id="slot-res" style="margin-top:20px; font-family:'Orbitron';">JALA LA PALANCA</h2>
                <p>Costo: 10 Tokens (o 1 tiro gratis)</p>
            `;
        } else if(g === 'PLINKO') {
            cont.innerHTML = `
                <div style="background:#000; width:300px; height:400px; border:2px solid #333; margin:0 auto; position:relative; overflow:hidden;">
                    <div id="ball" style="width:15px; height:15px; background:var(--accent); border-radius:50%; position:absolute; top:20px; left:50%; transform:translateX(-50%); display:none;"></div>
                    <div style="margin-top:50px; display:grid; grid-template-columns:repeat(7, 1fr); gap:10px; padding:20px; opacity:0.5;">
                        ${Array(20).fill('‚Ä¢').join(' ')}
                    </div>
                    <div class="plinko-multipliers" style="position:absolute; bottom:0;">
                        <div class="mult-box" style="background:#ff3b3b">x0.2</div>
                        <div class="mult-box" style="background:#ff9f43">x1.5</div>
                        <div class="mult-box" style="background:var(--accent); color:black">x5.0</div>
                        <div class="mult-box" style="background:#ff9f43">x1.5</div>
                        <div class="mult-box" style="background:#ff3b3b">x0.2</div>
                    </div>
                </div>
                <button class="btn btn-accent" style="margin-top:20px" onclick="playPlinko()">SOLTAR BOLA</button>
            `;
        }
    }

    function pullLever() {
        if(db.free <= 0 && db.bal < 10) return alert("Sin saldo");
        
        const lever = document.getElementById('lever');
        lever.classList.add('pulled');
        setTimeout(() => lever.classList.remove('pulled'), 500);

        if(db.free > 0) db.free--; else db.bal -= 10;
        refresh();

        const symbols = ["üçé", "üçí", "üçè", "7Ô∏è‚É£", "üíé"];
        const r1 = document.getElementById('r1');
        const r2 = document.getElementById('r2');
        const r3 = document.getElementById('r3');

        r1.classList.add('spinning'); r2.classList.add('spinning'); r3.classList.add('spinning');

        setTimeout(() => {
            r1.classList.remove('spinning'); r1.innerText = symbols[Math.floor(Math.random()*5)];
            setTimeout(() => {
                r2.classList.remove('spinning'); r2.innerText = symbols[Math.floor(Math.random()*5)];
                setTimeout(() => {
                    r3.classList.remove('spinning'); r3.innerText = symbols[Math.floor(Math.random()*5)];
                    checkSlots(r1.innerText, r2.innerText, r3.innerText);
                }, 300);
            }, 300);
        }, 1000);
    }

    function checkSlots(a, b, c) {
        const res = document.getElementById('slot-res');
        if(a === "7Ô∏è‚É£" && b === "7Ô∏è‚É£" && c === "7Ô∏è‚É£") {
            db.bal += 200; confetti(); res.innerText = "JACKPOT 777! +200";
        } else if(a === b && b === c) {
            db.bal += 50; confetti(); res.innerText = "¬°PREMIO MAYOR! +50";
        } else if(a === b || b === c) {
            db.bal += 15; res.innerText = "PAR GANADOR! +15";
        } else {
            res.innerText = "SIGUE INTENTANDO";
        }
        refresh();
    }

    function closeG() {
        document.getElementById('game-selection').style.display = 'grid';
        document.getElementById('game-stage').style.display = 'none';
    }

    // --- COMERCIO ---
    function renderMarket() {
        const list = document.getElementById('m-list');
        list.innerHTML = db.market.length === 0 ? "<p>No hay art√≠culos en venta.</p>" : "";
        db.market.forEach((i, idx) => {
            list.innerHTML += `<div class="glass-card"><h4>${i.n}</h4><p>Vendido por: ${i.v}</p><button class="btn btn-gold" style="width:100%" onclick="buyMarket(${idx})">COMPRAR POR ${i.p}</button></div>`;
        });
    }

    function buyMarket(idx) {
        let itm = db.market[idx];
        if(db.bal >= itm.p) {
            db.bal -= itm.p;
            db.inv.push(itm.n);
            db.market.splice(idx, 1);
            refresh();
        }
    }

    // --- INVENTARIO ---
    function renderInv() {
        const list = document.getElementById('inv-list');
        list.innerHTML = "";
        db.inv.forEach((i, idx) => {
            list.innerHTML += `<div class="glass-card"><h4>${i}</h4>
                <button class="btn btn-accent" style="width:100%; font-size:0.7rem; margin-bottom:5px;" onclick="claim('${i}', ${idx})">RECLAMAR WA</button>
                <button class="btn btn-gold" style="width:100%; font-size:0.7rem;" onclick="sellM('${i}', ${idx})">VENDER EN MERCADO</button>
            </div>`;
        });
    }

    function sellM(name, idx) {
        let price = prompt("¬øPrecio de venta en Tokens?");
        if(price) {
            db.market.push({n: name, p: parseFloat(price), v: db.u});
            db.inv.splice(idx, 1);
            refresh();
        }
    }

    function claim(item, idx) {
        window.open(`https://wa.me/593987749885?text=Soy ${db.u}, reclamo mi premio: ${item}`);
        db.inv.splice(idx, 1);
        refresh();
    }

    // --- ADMIN ---
    function adminCreateBox() {
        let n = document.getElementById('adm-box-n').value;
        let p = document.getElementById('adm-box-p').value;
        let itms = document.getElementById('adm-box-items').value.split(",");
        if(itms.length < 2) return alert("Pon al menos 2 premios");
        db.boxes.push({n, p, items: itms});
        save();
        alert("¬°Caja publicada!");
    }
</script>
</body>
</html>
