<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SMAL EMPIRE | ELITE V6 - Casino</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
<style>
:root {
  --bg: #040609; --card: #0d1117; --accent: #00ff59; --gold: #f5d033;
  --text: #ffffff; --text-dim: #8b949e; --border: #21262d; --red: #ff4747;
}
*{box-sizing:border-box;font-family:'Plus Jakarta Sans',sans-serif;transition:0.3s cubic-bezier(0.175,0.885,0.32,1.275);}
body{background:var(--bg);color:var(--text);margin:0;height:100vh;display:flex;overflow:hidden;}
aside.sidebar{width:260px;background:var(--card);border-right:1px solid var(--border);display:flex;flex-direction:column;z-index:100;}
aside.sidebar .profile{padding:30px;text-align:center;}
#u-ava{width:65px;height:65px;background:var(--accent);color:black;border-radius:20px;display:flex;align-items:center;justify-content:center;margin:0 auto 15px;font-weight:900;font-size:1.8rem;user-select:none;}
#u-name{margin:0;font-weight:700;font-size:1.2rem;}
#u-bal{color:var(--gold);font-weight:900;font-size:1.4rem;margin-top:10px;}
nav{display:flex;flex-direction:column;}
nav .nav-item{padding:15px 25px;cursor:pointer;color:var(--text-dim);display:flex;align-items:center;gap:12px;font-weight:600;border-left:4px solid transparent;user-select:none;}
nav .nav-item.active,nav .nav-item:hover{background:#161b22;color:var(--accent);border-left-color:var(--accent);}
main.main{flex:1;overflow-y:auto;padding:30px;position:relative;background:radial-gradient(circle at 50% 0%,#1a2c38,var(--bg));max-height:100vh;}
.view{display:none;animation:fadeIn 0.4s ease;max-width:1200px;margin:0 auto;}
.view.active{display:block;}
@keyframes fadeIn{from{opacity:0;}to{opacity:1;}}
.glass-card{background:rgba(13,17,23,0.85);border:1px solid var(--border);border-radius:20px;padding:25px;margin-bottom:20px;box-shadow:0 0 20px rgba(0,255,89,0.2);}
.btn{padding:12px 25px;border:none;border-radius:8px;font-weight:800;cursor:pointer;text-transform:uppercase;box-shadow:0 4px 15px rgba(0,0,0,0.3);user-select:none;}
.btn-accent{background:var(--accent);color:#000;}
.btn-gold{background:var(--gold);color:#000;}
.btn-red{background:var(--red);color:#000;}
.error-msg{color:var(--red);text-align:center;margin-bottom:15px;font-weight:600;}
#login-container,#register-container{width:320px;margin:auto;padding:40px 30px;background:var(--card);border-radius:25px;box-shadow:0 0 40px rgba(0,255,89,0.4);user-select:none;}
#login-container h2,#register-container h2{text-align:center;color:var(--accent);margin-bottom:25px;letter-spacing:4px;font-family:'Orbitron',sans-serif;}
#login-container input,#register-container input{width:100%;padding:12px;margin-bottom:15px;border-radius:8px;border:none;font-size:1rem;}
#login-container input::placeholder,#register-container input::placeholder{color:var(--text-dim);}
.game-card{cursor:pointer;text-align:center;}
#game-content{margin-top:20px;}
#inv-list,#m-list{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:15px;}
.card{background:rgba(13,17,23,0.85);border:1px solid var(--border);border-radius:15px;padding:15px;text-align:center;box-shadow:0 0 10px rgba(0,255,89,0.2);}
.admin-section input[type=text],.admin-section input[type=number]{width:150px;padding:5px;border-radius:5px;border:none;margin-right:5px;}
@media (max-width:900px){aside.sidebar{width:100%;height:auto;border-right:none;border-bottom:1px solid var(--border);flex-direction:row;justify-content:space-around;padding:10px 0;}main.main{padding:15px;}}
</style>
</head>
<body>

<!-- Login -->
<div id="login-screen" style="width:100vw;height:100vh;background:var(--bg);display:flex;align-items:center;justify-content:center;">
  <div id="login-container">
    <h2>SMAL EMPIRE</h2>
    <input type="text" id="login-username" placeholder="Usuario" autocomplete="username"/>
    <input type="password" id="login-password" placeholder="Contrase√±a" autocomplete="current-password"/>
    <div class="error-msg" id="login-error"></div>
    <button class="btn btn-accent" onclick="loginUser()">Entrar</button>
    <button class="btn btn-gold" style="margin-top:10px;" onclick="showRegister()">Registrarme</button>
  </div>
</div>

<!-- Register -->
<div id="register-screen" style="display:none;width:100vw;height:100vh;background:var(--bg);display:flex;align-items:center;justify-content:center;">
  <div id="register-container">
    <h2>REGISTRARSE</h2>
    <input type="text" id="reg-username" placeholder="Usuario" autocomplete="username"/>
    <input type="password" id="reg-password" placeholder="Contrase√±a" autocomplete="new-password"/>
    <input type="password" id="reg-password2" placeholder="Confirmar contrase√±a" autocomplete="new-password"/>
    <div class="error-msg" id="reg-error"></div>
    <button class="btn btn-accent" onclick="registerUser()">Crear Cuenta</button>
    <button class="btn btn-gold" style="margin-top:10px;" onclick="showLogin()">Volver al Login</button>
  </div>
</div>

<!-- Sidebar -->
<aside class="sidebar" style="display:none;">
  <div class="profile">
    <div id="u-ava">?</div>
    <h3 id="u-name">-</h3>
    <div>ü™ô <span id="u-bal">0</span> tokens</div>
    <div style="margin-top:5px;font-size:0.9rem;color:var(--accent);font-weight:700;">üéüÔ∏è Tiradas gratis: <span id="u-free">0</span></div>
  </div>
  <nav>
    <div class="nav-item active" onclick="nav('home')">üè† Inicio</div>
    <div class="nav-item" onclick="nav('games')">üé∞ Juegos</div>
    <div class="nav-item" onclick="nav('boxes')">üì¶ Cajas Misteriosas</div>
    <div class="nav-item" onclick="nav('shop')">üõí Comprar Tokens</div>
    <div class="nav-item" onclick="nav('inv')">üéí Inventario</div>
    <div class="nav-item" onclick="nav('market')">‚öñÔ∏è Mercado P2P</div>
    <div class="nav-item" id="adm-btn" onclick="nav('admin')">üõ† Panel Maestro</div>
    <div class="nav-item" onclick="logout()">üö™ Salir</div>
  </nav>
</aside>

<!-- Main -->
<main class="main" style="display:none;">
  <!-- Home -->
  <section id="v-home" class="view active">
    <h1 style="font-family:'Orbitron';margin-bottom:20px;">LOBBY DEL <span style="color:var(--accent)">IMPERIO</span></h1>
    <div class="glass-card" style="border-left:5px solid var(--accent);">
      <h3>Noticias Globales</h3>
      <p>¬°El sistema de comercio ya est√° activo! Vende tus premios a otros jugadores.</p>
    </div>
  </section>

  <!-- Juegos -->
  <section id="v-games" class="view">
    <h1 style="font-family:'Orbitron';margin-bottom:20px;">JUEGOS ELITE</h1>
    <div id="game-selection" style="display:grid;grid-template-columns:repeat(3,1fr);gap:20px;">
      <div class="glass-card game-card" onclick="openGame('SLOTS')">
        <h2>üé∞ SLOTS FRUIT</h2>
        <p>Jackpot 777</p>
      </div>
      <div class="glass-card game-card" onclick="openGame('MINES')">
        <h2>üí£ MINES</h2>
        <p>Multiplicador x10</p>
      </div>
      <div class="glass-card game-card" onclick="openGame('PLINKO')">
        <h2>üîµ PLINKO</h2>
        <p>Ca√≠da de suerte</p>
      </div>
    </div>
    <div id="game-stage" style="display:none;text-align:center;padding-top:20px;">
      <div id="game-content"></div>
      <button class="btn btn-gold" style="margin-top:40px;" onclick="closeGame()">Volver al men√∫</button>
    </div>
  </section>

  <!-- Boxes -->
  <section id="v-boxes" class="view">
    <h1>Cajas Misteriosas</h1>
    <div id="boxes-list" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:15px;"></div>
  </section>

  <!-- Shop -->
  <section id="v-shop" class="view">
    <h1>Comprar Tokens</h1>
    <div class="glass-card" style="text-align:center;">
      <button class="btn btn-gold" onclick="buyTokens(100)">Comprar 100 Tokens - $1</button>
      <button class="btn btn-gold" onclick="buyTokens(500)" style="margin-left:10px;">Comprar 500 Tokens - $4</button>
    </div>
  </section>

  <!-- Inventory -->
  <section id="v-inv" class="view">
    <h1>Inventario</h1>
    <div id="inv-list"></div>
  </section>

  <!-- Market -->
  <section id="v-market" class="view">
    <h1>Mercado P2P</h1>
    <div id="m-list"></div>
  </section>

  <!-- Admin -->
  <section id="v-admin" class="view">
    <h1>Panel Maestro</h1>
    <div class="admin-section">
      <h3>Crear Caja Misteriosa</h3>
      <input type="text" id="box-name" placeholder="Nombre Caja"/>
      <input type="number" id="box-price" placeholder="Precio"/>
      <button class="btn btn-accent" onclick="createBox()">Crear</button>
      <div id="admin-boxes" style="margin-top:15px;"></div>
    </div>
  </section>
</main>

<script>
// --- Datos iniciales ---
let users = JSON.parse(localStorage.getItem('users')) || [];
let boxes = JSON.parse(localStorage.getItem('boxes')) || [];
let market = JSON.parse(localStorage.getItem('market')) || [];
if(!users.some(u=>u.username==='maestro')){
  users.push({username:'maestro',password:'EliteV6!',balance:0,freeSpins:0,inventory:[],admin:true});
  localStorage.setItem('users',JSON.stringify(users));
}
let currentUser = null;

// --- Navegaci√≥n ---
function nav(view){
  document.querySelectorAll('.view').forEach(v=>v.classList.remove('active'));
  document.getElementById('v-'+view).classList.add('active');
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  document.querySelector(`.nav-item[onclick="nav('${view}')"]`)?.classList.add('active');
  if(view==='inv') renderInventory();
  if(view==='market') renderMarket();
  if(view==='boxes') renderBoxes();
  if(view==='admin') renderAdminBoxes();
}

// --- Login/Register ---
function showRegister(){document.getElementById('login-screen').style.display='none';document.getElementById('register-screen').style.display='flex';}
function showLogin(){document.getElementById('register-screen').style.display='none';document.getElementById('login-screen').style.display='flex';}

function registerUser(){
  let u=document.getElementById('reg-username').value.trim();
  let p=document.getElementById('reg-password').value;
  let p2=document.getElementById('reg-password2').value;
  let err=document.getElementById('reg-error'); err.textContent='';
  if(!u||!p){err.textContent='Usuario y contrase√±a requeridos';return;}
  if(p!==p2){err.textContent='Contrase√±as no coinciden';return;}
  if(users.some(x=>x.username===u)){err.textContent='Usuario ya existe';return;}
  let newUser={username:u,password:p,balance:100,freeSpins:1,inventory:[],admin:false};
  users.push(newUser); localStorage.setItem('users',JSON.stringify(users));
  alert('Cuenta creada!'); showLogin();
}

function loginUser(){
  let u=document.getElementById('login-username').value.trim();
  let p=document.getElementById('login-password').value;
  let err=document.getElementById('login-error'); err.textContent='';
  let user=users.find(x=>x.username===u&&x.password===p);
  if(!user){err.textContent='Usuario o contrase√±a incorrectos';return;}
  currentUser=user; updateProfile(); document.getElementById('login-screen').style.display='none';
  document.getElementById('register-screen').style.display='none';
  document.querySelector('aside.sidebar').style.display='flex';
  document.querySelector('main.main').style.display='block';
  if(user.admin) document.getElementById('adm-btn').style.display='block';
}

// --- Logout ---
function logout(){currentUser=null; document.querySelector('aside.sidebar').style.display='none'; document.querySelector('main.main').style.display='none'; document.getElementById('login-screen').style.display='flex';}

// --- Update Profile ---
function updateProfile(){
  document.getElementById('u-name').textContent=currentUser.username;
  document.getElementById('u-bal').textContent=currentUser.balance;
  document.getElementById('u-free').textContent=currentUser.freeSpins;
}

// --- Juegos placeholder ---
function openGame(game){
  document.getElementById('game-selection').style.display='none';
  document.getElementById('game-stage').style.display='block';
  let content=document.getElementById('game-content'); 
  content.innerHTML='';
  if(game==='SLOTS'){
    content.innerHTML=`<p>üé∞ Slots - Gira el slot!</p><button class="btn btn-accent" onclick="playSlots()">Girar</button>`;
  } else if(game==='MINES'){
    content.innerHTML=`<p>üí£ Mines - Encuentra el multiplicador!</p><button class="btn btn-accent" onclick="playMines()">Jugar</button>`;
  } else if(game==='PLINKO'){
    content.innerHTML=`<p>üîµ Plinko - Suerte al caer!</p><button class="btn btn-accent" onclick="playPlinko()">Soltar</button>`;
  }
}
function closeGame(){
  document.getElementById('game-selection').style.display='grid';
  document.getElementById('game-stage').style.display='none';
}

// --- Slots demo ---
function playSlots(){
  let reels=['üçí','üçã','üçâ','üçá','7Ô∏è‚É£'];
  let r1=reels[Math.floor(Math.random()*reels.length)];
  let r2=reels[Math.floor(Math.random()*reels.length)];
  let r3=reels[Math.floor(Math.random()*reels.length)];
  alert(`Resultado: ${r1} | ${r2} | ${r3}`);
  if(r1===r2&&r2===r3){alert('¬°Ganaste 50 tokens!');currentUser.balance+=50;}
  else if(r1===r2||r2===r3||r1===r3){alert('¬°Ganaste 10 tokens!');currentUser.balance+=10;}
  else{alert('Intenta de nuevo');}
  saveUserData();
}

// --- Mines demo ---
function playMines(){
  let win=Math.random()<0.3;
  if(win){alert('¬°Ganaste x5!');currentUser.balance+=50;}
  else{alert('üí£ Boom! No ganaste');}
  saveUserData();
}

// --- Plinko demo ---
function playPlinko(){
  let mult=[1,2,3,5,10]; let val=mult[Math.floor(Math.random()*mult.length)];
  alert(`Multiplicador: x${val}`); currentUser.balance+=val*10;
  saveUserData();
}

// --- Boxes ---
function renderBoxes(){
  let container=document.getElementById('boxes-list'); container.innerHTML='';
  boxes.forEach((b,i)=>{
    let div=document.createElement('div'); div.className='card';
    div.innerHTML=`<h3>${b.name}</h3><p>Precio: ${b.price} tokens</p><button class="btn btn-accent" onclick="openBox(${i})">Abrir Caja</button>`;
    container.appendChild(div);
  });
}
function openBox(index){
  let box=boxes[index];
  if(currentUser.balance<box.price){alert('No tienes suficientes tokens');return;}
  currentUser.balance-=box.price;
  let rnd=Math.random()*100;
  let acc=0; let reward='';
  for(let p of box.items){acc+=p.chance; if(rnd<=acc){reward=p.name; break;}}
  if(!reward) reward=box.items[box.items.length-1].name;
  currentUser.inventory.push(reward);
  alert(`¬°Has recibido: ${reward}!`);
  saveUserData();
}

// --- Shop ---
function buyTokens(qty){currentUser.balance+=qty; saveUserData(); alert('Tokens comprados!');}

// --- Inventory ---
function renderInventory(){
  let container=document.getElementById('inv-list'); container.innerHTML='';
  currentUser.inventory.forEach((it,i)=>{
    let div=document.createElement('div'); div.className='card';
    div.innerHTML=`${it}<br><button class="btn btn-gold" onclick="sellItem(${i})">Vender 50 tokens</button>`;
    container.appendChild(div);
  });
}
function sellItem(index){
  let item=currentUser.inventory.splice(index,1)[0];
  currentUser.balance+=50;
  market.push({name:item,owner:currentUser.username});
  saveUserData();
  renderInventory(); renderMarket();
  alert(`¬°${item} vendido al mercado!`);
}

// --- Market ---
function renderMarket(){
  let container=document.getElementById('m-list'); container.innerHTML='';
  market.forEach((m,i)=>{
    let div=document.createElement('div'); div.className='card';
    div.innerHTML=`${m.name} <br>Due√±o: ${m.owner}<br><button class="btn btn-accent" onclick="buyMarket(${i})">Comprar 50 tokens</button>`;
    container.appendChild(div);
  });
}
function buyMarket(index){
  let item=market[index];
  if(currentUser.balance<50){alert('No tienes tokens');return;}
  currentUser.balance-=50;
  currentUser.inventory.push(item.name);
  market.splice(index,1);
  saveUserData(); renderInventory(); renderMarket();
}

// --- Admin ---
function createBox(){
  let name=document.getElementById('box-name').value;
  let price=parseInt(document.getElementById('box-price').value);
  if(!name||!price){alert('Completa los campos');return;}
  let newBox={name:name,price:price,items:[{name:'Premio 1',chance:50},{name:'Premio 2',chance:30},{name:'Premio 3',chance:20}]};
  boxes.push(newBox); localStorage.setItem('boxes',JSON.stringify(boxes));
  renderAdminBoxes(); renderBoxes();
}
function renderAdminBoxes(){
  let container=document.getElementById('admin-boxes'); container.innerHTML='';
  boxes.forEach((b,i)=>{
    let div=document.createElement('div'); div.className='card';
    div.innerHTML=`${b.name} - ${b.price} tokens <button class="btn btn-red" onclick="deleteBox(${i})">Eliminar</button>`;
    container.appendChild(div);
  });
}
function deleteBox(i){boxes.splice(i,1); localStorage.setItem('boxes',JSON.stringify(boxes)); renderAdminBoxes(); renderBoxes();}

// --- Save ---
function saveUserData(){ 
  let idx=users.findIndex(u=>u.username===currentUser.username);
  if(idx>=0){users[idx]=currentUser; localStorage.setItem('users',JSON.stringify(users)); updateProfile();}
}
</script>
</body>
</html>
