<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMAL EMPIRE V17 | ENGINE EDITION</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <script src="https://www.paypal.com/sdk/js?client-id=AY9cjKW9uJqtsEJeZ6VyY6S-feyCF_30R-DFGd3FH-Ccznh8IXE9lek4MlUTIVWKMkrt0l7-TEgUMYJa&currency=USD"></script>
    <style>
        :root { --bg: #020408; --card: #0b0f15; --accent: #00ff88; --gold: #ffcc00; --red: #ff3333; --border: #1e2530; }
        body { background: var(--bg); color: white; font-family: 'Plus Jakarta Sans', sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* SIDEBAR PROFESIONAL */
        .sidebar { width: 260px; background: var(--card); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 20px; }
        .nav-btn { padding: 15px; cursor: pointer; border-radius: 10px; margin-bottom: 5px; font-weight: 700; color: #8b949e; display: flex; align-items: center; gap: 10px; }
        .nav-btn:hover, .nav-btn.active { background: #161b22; color: var(--accent); }

        /* MAIN CONTENT */
        .main { flex: 1; padding: 40px; overflow-y: auto; position: relative; }
        .view { display: none; animation: slideIn 0.3s ease; }
        .view.active { display: block; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* GAME ENGINE UI */
        .game-screen { background: #000; border: 2px solid var(--accent); border-radius: 20px; padding: 40px; text-align: center; position: relative; min-height: 400px; display: flex; flex-direction: column; justify-content: center; }
        .slot-machine { display: flex; justify-content: center; gap: 15px; margin: 30px 0; }
        .reel { width: 80px; height: 100px; background: #111; border: 2px solid var(--border); border-radius: 10px; font-size: 3rem; line-height: 100px; }
        
        /* CARDS */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 15px; padding: 15px; text-align: center; transition: 0.3s; }
        .card:hover { border-color: var(--accent); transform: translateY(-5px); }
        .card img { width: 100%; border-radius: 10px; height: 120px; object-fit: cover; }

        /* ADMIN "CANVA" STYLE */
        .admin-panel { background: #111; padding: 25px; border-radius: 20px; border: 1px dashed var(--gold); }
        .btn { background: var(--accent); color: #000; border: none; padding: 12px 25px; border-radius: 8px; font-weight: 800; cursor: pointer; width: 100%; margin-top: 10px; }
        .input { background: #000; border: 1px solid var(--border); color: white; padding: 12px; border-radius: 8px; width: 100%; margin-bottom: 10px; }
        
        #overlay { position: fixed; inset: 0; background: var(--bg); z-index: 1000; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>

<div id="overlay">
    <div class="card" style="width: 350px; border: 2px solid var(--accent);">
        <h1 style="font-family: 'Orbitron'; color: var(--accent);">SMAL EMPIRE</h1>
        <input type="text" id="user-in" class="input" placeholder="Usuario">
        <input type="password" id="pass-in" class="input" placeholder="Contrase√±a">
        <button class="btn" onclick="app.login()">ENTRAR AL IMPERIO</button>
    </div>
</div>

<aside class="sidebar">
    <div style="text-align: center; margin-bottom: 30px;">
        <h2 style="font-family: 'Orbitron'; color: var(--accent);">V17 PRO</h2>
        <div style="background: #000; padding: 15px; border-radius: 12px; border: 1px solid var(--gold);">
            <small style="color: #8b949e;">SALDO</small><br>
            <span style="font-size: 1.5rem; color: var(--gold); font-weight: 800;">ü™ô <span id="u-bal">0</span></span>
        </div>
    </div>
    <div class="nav-btn active" onclick="ui.view('lobby')">üè† Lobby</div>
    <div class="nav-btn" onclick="ui.view('games')">üé∞ Juegos</div>
    <div class="nav-btn" onclick="ui.view('cases')">üì¶ Cajas</div>
    <div class="nav-btn" onclick="ui.view('shop')">üí∞ Tienda</div>
    <div class="nav-btn" onclick="ui.view('inv')">üéí Inventario</div>
    <div id="adm-nav" class="nav-btn" style="display:none; color: var(--gold);" onclick="ui.view('admin')">üõ† Panel Maestro</div>
    <div class="nav-btn" style="margin-top: auto; color: var(--red);" onclick="location.reload()">üö™ Salir</div>
</aside>

<main class="main">
    <div id="v-lobby" class="view active">
        <h1>Bienvenido, <span id="u-name" style="color: var(--accent);">---</span></h1>
        <div class="grid">
            <div class="card"><h3>Usuarios</h3><h2>2,501</h2></div>
            <div class="card"><h3>Pagos Hoy</h3><h2>$4,200</h2></div>
        </div>
        <div class="card" style="margin-top: 20px; text-align: left;">
            <h3>Soporte Directo</h3>
            <p>WhatsApp: <a href="https://wa.me/593987749885" style="color: var(--accent);">+593987749885</a></p>
        </div>
    </div>

    <div id="v-games" class="view">
        <div id="games-menu">
            <h1>SALA DE JUEGOS</h1>
            <div class="grid" id="game-list"></div>
        </div>
        <div id="game-engine" style="display: none;">
            <button onclick="ui.view('games')" style="background: none; border: 1px solid white; color: white; cursor: pointer; padding: 5px 15px; border-radius: 5px; margin-bottom: 15px;">‚Üê Volver</button>
            <div class="game-screen" id="game-canvas">
                </div>
        </div>
    </div>

    <div id="v-shop" class="view">
        <h1>TIENDA DE TOKENS</h1>
        <div class="card" style="max-width: 450px; margin: 0 auto;">
            <p>1 USD = 10 Tokens</p>
            <input type="number" id="buy-amt" class="input" value="800" oninput="ui.calc()">
            <h2 style="color: var(--gold);">$ <span id="buy-price">80.00</span> USD</h2>
            <div id="paypal-btn"></div>
        </div>
    </div>

    <div id="v-admin" class="view">
        <h1>CONSTRUCTOR DEL IMPERIO</h1>
        <div class="admin-panel">
            <h3>üî® Creador de Juegos Din√°micos</h3>
            <input type="text" id="new-g-name" class="input" placeholder="Nombre del Juego">
            <input type="text" id="new-g-img" class="input" placeholder="URL de Imagen (Unsplash)">
            <input type="number" id="new-g-mult" class="input" placeholder="Multiplicador (ej: 2.5)">
            <button class="btn" onclick="app.createGame()">PUBLICAR JUEGO</button>
        </div>
        <div class="admin-panel" style="margin-top: 20px;">
            <h3>üë• Gestionar Usuario</h3>
            <input type="text" id="adm-u" class="input" placeholder="Nombre de usuario">
            <input type="number" id="adm-b" class="input" placeholder="Nuevo Saldo">
            <button class="btn" style="background: var(--gold);" onclick="app.setBal()">MODIFICAR SALDO</button>
        </div>
    </div>

    <div id="v-cases" class="view"><h1>CAJAS PR√ìXIMAMENTE</h1></div>
    <div id="v-inv" class="view"><h1>MI INVENTARIO</h1></div>
</main>

<script>
// --- MOTOR L√ìGICO ---
const app = {
    db: JSON.parse(localStorage.getItem('smal_v17')) || {
        users: [{u:'maestro', p:'Elite2026', bal:10000, admin:true}],
        games: [
            {n: 'Diamond Slots', i: 'https://images.unsplash.com/photo-1518623489648-a173ef7824f3?w=300', m: 3},
            {n: 'Cyber Roulette', i: 'https://images.unsplash.com/photo-1606167668584-78701c57f13d?w=300', m: 2}
        ]
    },
    user: null,

    login() {
        const u = document.getElementById('user-in').value.toLowerCase();
        const p = document.getElementById('pass-in').value;
        let found = this.db.users.find(x => x.u === u);
        if(!found) {
            found = {u, p, bal: 500, admin: false, inv: []};
            this.db.users.push(found);
        }
        if(found.p === p) {
            this.user = found;
            document.getElementById('overlay').style.display = 'none';
            if(found.admin) document.getElementById('adm-nav').style.display = 'flex';
            document.getElementById('u-name').innerText = u.toUpperCase();
            this.update();
            ui.renderGames();
            ui.initPaypal();
        }
    },

    update() {
        document.getElementById('u-bal').innerText = Math.floor(this.user.bal);
        localStorage.setItem('smal_v17', JSON.stringify(this.db));
    },

    createGame() {
        const n = document.getElementById('new-g-name').value;
        const i = document.getElementById('new-g-img').value;
        const m = document.getElementById('new-g-mult').value;
        if(n && i && m) {
            this.db.games.push({n, i, m: parseFloat(m)});
            this.update();
            ui.renderGames();
            alert("Juego Publicado con √âxito");
        }
    },

    setBal() {
        const u = document.getElementById('adm-u').value.toLowerCase();
        const b = parseInt(document.getElementById('adm-b').value);
        const target = this.db.users.find(x => x.u === u);
        if(target) { target.bal = b; this.update(); alert("Saldo actualizado"); }
    }
};

// --- INTERFAZ DIN√ÅMICA ---
const ui = {
    view(id) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById('v-'+id).classList.add('active');
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        if(id === 'games') {
            document.getElementById('games-menu').style.display = 'block';
            document.getElementById('game-engine').style.display = 'none';
        }
    },

    calc() {
        const amt = document.getElementById('buy-amt').value;
        document.getElementById('buy-price').innerText = (amt / 10).toFixed(2);
    },

    renderGames() {
        const list = document.getElementById('game-list');
        list.innerHTML = app.db.games.map((g, idx) => `
            <div class="card">
                <img src="${g.i}">
                <h4>${g.n}</h4>
                <button class="btn" onclick="ui.launchGame(${idx})">JUGAR AHORA</button>
            </div>
        `).join('');
    },

    launchGame(idx) {
        const game = app.db.games[idx];
        document.getElementById('games-menu').style.display = 'none';
        document.getElementById('game-engine').style.display = 'block';
        
        const canvas = document.getElementById('game-canvas');
        canvas.innerHTML = `
            <h1 style="color:var(--gold)">${game.n}</h1>
            <p>Costo por tirada: 50 Tokens | Multiplicador: x${game.m}</p>
            <div class="slot-machine">
                <div id="r1" class="reel">?</div>
                <div id="r2" class="reel">?</div>
                <div id="r3" class="reel">?</div>
            </div>
            <button class="btn" style="max-width:300px; margin:0 auto;" onclick="ui.runLogic(${game.m})">APRESTAR GATILLO</button>
        `;
    },

    runLogic(mult) {
        if(app.user.bal < 50) return alert("No tienes saldo");
        app.user.bal -= 50;
        
        const symbols = ['üíé', 'üí∞', '7Ô∏è‚É£', 'üî•', 'üçí'];
        const res = [symbols[Math.floor(Math.random()*5)], symbols[Math.floor(Math.random()*5)], symbols[Math.floor(Math.random()*5)]];
        
        document.getElementById('r1').innerText = res[0];
        document.getElementById('r2').innerText = res[1];
        document.getElementById('r3').innerText = res[2];

        if(res[0] === res[1] && res[1] === res[2]) {
            const win = 50 * mult;
            app.user.bal += win;
            confetti();
            alert("¬°GANASTE " + win + " TOKENS!");
        }
        app.update();
    },

    initPaypal() {
        paypal.Buttons({
            createOrder: (data, actions) => {
                return actions.order.create({ purchase_units: [{ amount: { value: document.getElementById('buy-price').innerText } }] });
            },
            onApprove: (data, actions) => {
                return actions.order.capture().then(() => {
                    app.user.bal += parseInt(document.getElementById('buy-amt').value);
                    app.update();
                    alert("Compra exitosa");
                });
            }
        }).render('#paypal-btn');
    }
};
</script>
</body>
</html>
