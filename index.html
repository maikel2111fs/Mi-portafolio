<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMAL EMPIRE | ULTIMATE V14</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Plus+Jakarta+Sans:wght@400;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <script src="https://www.paypal.com/sdk/js?client-id=AY9cjKW9uJqtsEJeZ6VyY6S-feyCF_30R-DFGd3FH-Ccznh8IXE9lek4MlUTIVWKMkrt0l7-TEgUMYJa&currency=USD"></script>
    <style>
        :root { 
            --bg: #05070a; --card: #0f1218; --accent: #00ff59; --gold: #f5d033; 
            --red: #eb4b4b; --purple: #a34cff; --blue: #4b69ff; --border: #1f2630; 
        }
        * { box-sizing: border-box; font-family: 'Plus Jakarta Sans', sans-serif; cursor: default; }
        body { background: var(--bg); color: white; margin: 0; display: flex; height: 100vh; overflow: hidden; }

        /* --- SIDEBAR --- */
        .sidebar { width: 280px; background: var(--card); border-right: 1px solid var(--border); display: flex; flex-direction: column; }
        .nav-item { padding: 18px 25px; cursor: pointer; color: #8b949e; font-weight: 800; border-left: 4px solid transparent; }
        .nav-item:hover { background: #161b22; color: white; }
        .nav-item.active { background: #1c232e; color: var(--accent); border-left-color: var(--accent); }

        /* --- MAIN AREA --- */
        .main { flex: 1; padding: 40px; overflow-y: auto; background: radial-gradient(circle at top right, #0d1a12, #05070a); }
        .view { display: none; }
        .view.active { display: block; animation: fadeIn 0.4s ease-out; }

        /* --- TIENDA CUSTOM --- */
        .shop-box { background: var(--card); padding: 30px; border-radius: 20px; border: 1px solid var(--gold); text-align: center; max-width: 500px; margin: 0 auto; }
        .price-display { font-size: 2.5rem; font-weight: 900; color: var(--gold); margin: 20px 0; }

        /* --- RUEDA DE CAJAS --- */
        .case-container { width: 100%; max-width: 700px; margin: 20px auto; background: #000; border: 2px solid var(--border); position: relative; overflow: hidden; border-radius: 12px; height: 150px; }
        .case-reel { display: flex; position: absolute; left: 0; top: 0; height: 100%; transition: transform 5s cubic-bezier(0.1, 0, 0.1, 1); }
        .case-item { min-width: 130px; height: 150px; display: flex; flex-direction: column; align-items: center; justify-content: center; border-right: 1px solid #111; border-bottom: 5px solid transparent; }
        .case-pointer { position: absolute; left: 50%; top: 0; bottom: 0; width: 3px; background: var(--accent); z-index: 10; transform: translateX(-50%); }

        /* --- INVENTARIO --- */
        .inv-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 15px; }
        .item-card { background: var(--card); border: 1px solid var(--border); padding: 15px; border-radius: 10px; text-align: center; font-size: 0.8rem; position: relative; }
        
        .rarity-blue { border-bottom: 4px solid var(--blue); }
        .rarity-purple { border-bottom: 4px solid var(--purple); }
        .rarity-red { border-bottom: 4px solid var(--red); }
        .rarity-gold { border-bottom: 4px solid var(--gold); animation: glow 2s infinite; }
        @keyframes glow { 0%, 100% { box-shadow: 0 0 5px var(--gold); } 50% { box-shadow: 0 0 15px var(--gold); } }

        /* --- BOTONES Y ENTRADAS --- */
        .btn { background: var(--accent); color: black; border: none; padding: 15px; border-radius: 8px; font-weight: 900; cursor: pointer; text-transform: uppercase; width: 100%; margin-top: 10px; }
        .input-pro { background: #000; border: 1px solid var(--border); color: white; padding: 12px; border-radius: 8px; width: 100%; margin-bottom: 10px; outline: none; text-align: center; font-size: 1.1rem; }
        
        #login-screen { position: fixed; inset: 0; background: var(--bg); z-index: 2000; display: flex; align-items: center; justify-content: center; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<aside class="sidebar">
    <div style="padding:40px 20px; text-align:center; border-bottom: 1px solid var(--border);">
        <h2 style="font-family:'Orbitron'; color:var(--accent); letter-spacing: 2px;">SMAL EMPIRE</h2>
        <div style="margin-top:20px; background:#000; padding:12px; border-radius:12px; border: 1px solid var(--border);">
            <div style="font-size: 0.7rem; color: #8b949e; margin-bottom: 5px;">SALDO ACTUAL</div>
            <span style="color:var(--gold); font-weight:900; font-size: 1.4rem;">ü™ô <span id="u-bal">0</span></span>
        </div>
    </div>
    <nav>
        <div class="nav-item active" onclick="ui.nav('lobby')">üè† INICIO</div>
        <div class="nav-item" onclick="ui.nav('cases')">üì¶ ABRIR CAJAS</div>
        <div class="nav-item" onclick="ui.nav('shop')">üí∞ COMPRAR COINS</div>
        <div class="nav-item" onclick="ui.nav('inv')">üéí INVENTARIO</div>
        <div class="nav-item" id="adm-tab" style="display:none; color:var(--gold)" onclick="ui.nav('admin')">üõ† PANEL MAESTRO</div>
        <div class="nav-item" style="color:var(--red); margin-top:auto;" onclick="location.reload()">üö™ SALIR</div>
    </nav>
</aside>

<main class="main">
    <div id="v-lobby" class="view active">
        <h1>BIENVENIDO AL <span style="color:var(--accent)">IMPERIO</span></h1>
        <p>Sistema de apuestas con skins y tokens reales optimizado para 2026.</p>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
            <div class="shop-box" style="margin:0; max-width:100%;">
                <h3>√öltimo Item Ganado</h3>
                <div id="recent-win" style="font-size: 1.2rem; color: var(--gold);">Ninguno todav√≠a</div>
            </div>
            <div class="shop-box" style="margin:0; max-width:100%;">
                <h3>Usuarios Online</h3>
                <div style="color:var(--accent); font-size: 1.5rem; font-weight: 900;">1,402</div>
            </div>
        </div>
    </div>

    <div id="v-shop" class="view">
        <h1 style="text-align: center;">TIENDA DE TOKENS</h1>
        <div class="shop-box">
            <p>1 USD = 10 TOKENS (Min. $10)</p>
            <label>¬øCu√°ntos tokens quieres?</label>
            <input type="number" id="coin-input" class="input-pro" value="800" oninput="ui.calcPrice()">
            <div class="price-display">$ <span id="price-val">80.00</span> USD</div>
            <div id="paypal-button-container"></div>
            <p style="font-size: 0.8rem; margin-top: 15px; color: #8b949e;">Pagos seguros v√≠a PayPal Encrypted</p>
        </div>
    </div>

    <div id="v-cases" class="view">
        <h1>SISTEMA DE APERTURA</h1>
        <div class="shop-box" style="max-width: 100%; margin-bottom: 20px;">
            <h2 id="case-title">Caja Alpha de Inicio</h2>
            <div class="case-container">
                <div class="case-pointer"></div>
                <div class="case-reel" id="case-reel"></div>
            </div>
            <button class="btn" id="btn-open" onclick="logic.openCase()">ABRIR POR 100 TOKENS</button>
        </div>
    </div>

    <div id="v-inv" class="view">
        <h1>MI INVENTARIO</h1>
        <div class="inv-grid" id="inv-grid"></div>
    </div>

    <div id="v-admin" class="view">
        <h1>üõ† CONFIGURACI√ìN MAESTRA</h1>
        <div class="shop-box" style="max-width: 100%; text-align: left;">
            <h3>A√±adir Nuevo Item a la Base</h3>
            <input type="text" id="adm-n" class="input-pro" placeholder="Nombre del Item">
            <select id="adm-r" class="input-pro">
                <option value="blue">Azul (Com√∫n)</option>
                <option value="purple">Morado (Raro)</option>
                <option value="red">Rojo (M√≠tico)</option>
                <option value="gold">Dorado (LEGENDARIO)</option>
            </select>
            <button class="btn" onclick="logic.addItem()">CREAR ITEM</button>
        </div>
    </div>
</main>

<div id="login-screen">
    <div class="shop-box">
        <h1 style="font-family:'Orbitron'; color:var(--accent)">ACCESO</h1>
        <input type="text" id="l-u" class="input-pro" placeholder="Usuario">
        <input type="password" id="l-p" class="input-pro" placeholder="Contrase√±a">
        <button class="btn" onclick="logic.auth()">INGRESAR AL SISTEMA</button>
    </div>
</div>

<script>
const ui = {
    nav: (id) => {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById('v-'+id).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        if(id === 'inv') logic.renderInv();
    },
    calcPrice: () => {
        const coins = document.getElementById('coin-input').value;
        const total = (coins / 10).toFixed(2);
        document.getElementById('price-val').innerText = total;
    }
};

const logic = {
    db: JSON.parse(localStorage.getItem('smal_v14')) || {
        users: [{u:'maestro', p:'Elite2026', bal:1000, admin:true, inv:[]}],
        items: [
            {n: 'Karambit | Gamma Doppler', r: 'gold'},
            {n: 'AWP | Asiimov', r: 'red'},
            {n: 'M4A1-S | Mecha', r: 'purple'},
            {n: 'Glock | Candy', r: 'blue'}
        ]
    },
    user: null,

    auth() {
        const u = document.getElementById('l-u').value.toLowerCase();
        const p = document.getElementById('l-p').value;
        if(!u || !p) return;
        let found = this.db.users.find(x => x.u === u);
        if(!found) {
            found = {u, p, bal:500, admin:false, inv:[]};
            this.db.users.push(found);
        }
        if(found.p === p) {
            this.user = found;
            document.getElementById('login-screen').style.display = 'none';
            if(found.admin) document.getElementById('adm-tab').style.display = 'block';
            this.update();
            this.initPaypal();
        }
    },

    update() {
        document.getElementById('u-bal').innerText = Math.floor(this.user.bal);
        localStorage.setItem('smal_v14', JSON.stringify(this.db));
    },

    renderInv() {
        const grid = document.getElementById('inv-grid');
        grid.innerHTML = this.user.inv.map(it => `
            <div class="item-card rarity-${it.r}">
                <div style="font-size:2rem; margin-bottom:10px;">üì¶</div>
                <b>${it.n}</b><br>
                <button onclick="logic.claim('${it.n}')" style="background:var(--accent); border:none; margin-top:10px; font-size:0.6rem; font-weight:900; padding:5px; border-radius:4px; cursor:pointer;">RECLAMAR</button>
            </div>
        `).join('');
    },

    claim(name) {
        const mail = "gancinomaikel@gmail.com";
        const body = `El usuario ${this.user.u} solicita el item: ${name}`;
        window.open(`mailto:${mail}?subject=RECLAMO ITEM&body=${body}`);
        this.user.inv = this.user.inv.filter(x => x.n !== name);
        this.update();
        this.renderInv();
    },

    openCase() {
        if(this.user.bal < 100) return alert("Faltan Tokens");
        this.user.bal -= 100;
        this.update();

        const reel = document.getElementById('case-reel');
        reel.style.transition = 'none';
        reel.style.transform = 'translateX(0)';
        
        let pool = [];
        let html = '';
        for(let i=0; i<60; i++) {
            const r = Math.random()*100;
            let item = r > 98 ? this.db.items.find(x => x.r === 'gold') : 
                       r > 85 ? this.db.items.find(x => x.r === 'red') :
                       r > 60 ? this.db.items.find(x => x.r === 'purple') : 
                       this.db.items.find(x => x.r === 'blue');
            if(!item) item = this.db.items[this.db.items.length-1];
            pool.push(item);
            html += `<div class="case-item rarity-${item.r}"><b>${item.n}</b></div>`;
        }
        reel.innerHTML = html;

        setTimeout(() => {
            reel.style.transition = 'transform 5s cubic-bezier(0.1, 0, 0.1, 1)';
            reel.style.transform = 'translateX(-' + (40 * 130 + Math.random()*100) + 'px)';
        }, 50);

        setTimeout(() => {
            const winner = pool[43];
            alert("¬°GANASTE: " + winner.n + "!");
            this.user.inv.push(winner);
            document.getElementById('recent-win').innerText = winner.n;
            if(winner.r === 'gold') confetti();
            this.update();
        }, 5500);
    },

    addItem() {
        const n = document.getElementById('adm-n').value;
        const r = document.getElementById('adm-r').value;
        if(n) {
            this.db.items.push({n, r});
            this.update();
            alert("Item guardado en la base del imperio.");
        }
    },

    initPaypal() {
        paypal.Buttons({
            createOrder: (data, actions) => {
                const total = document.getElementById('price-val').innerText;
                return actions.order.create({
                    purchase_units: [{ amount: { value: total } }]
                });
            },
            onApprove: (data, actions) => {
                return actions.order.capture().then(details => {
                    const coins = parseInt(document.getElementById('coin-input').value);
                    this.user.bal += coins;
                    this.update();
                    alert("TRANSACCI√ìN EXITOSA: +" + coins + " TOKENS");
                });
            }
        }).render('#paypal-button-container');
    }
};
</script>
</body>
</html>
