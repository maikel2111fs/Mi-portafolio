<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Casino Smal | Sistema Integrado</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root { 
            --bg-main: #0f212e; --bg-sidebar: #1a2c38; --bg-card: #213743;
            --accent: #00e701; --text: #b1bad3; --white: #ffffff; --lose: #ff3366;
        }
        * { box-sizing: border-box; font-family: 'Rajdhani', sans-serif; }
        body { background: var(--bg-main); color: var(--text); margin: 0; display: flex; height: 100vh; overflow: hidden; }

        /* --- MEN√ö LATERAL INTERACTIVO --- */
        .sidebar { width: 260px; background: var(--bg-sidebar); border-right: 1px solid #2f4553; display: flex; flex-direction: column; }
        .logo-area { padding: 25px; font-family: 'Orbitron'; color: var(--white); font-size: 1.5rem; border-bottom: 1px solid #2f4553; }
        .nav-group { padding: 20px 0; flex: 1; overflow-y: auto; }
        .nav-item { padding: 12px 25px; cursor: pointer; display: flex; align-items: center; gap: 12px; font-weight: 600; }
        .nav-item:hover, .nav-item.active { background: var(--bg-card); color: var(--white); }
        .nav-title { padding: 10px 25px; font-size: 0.75rem; color: #557086; text-transform: uppercase; }

        /* --- √ÅREA DE CONTENIDO --- */
        .main { flex: 1; display: flex; flex-direction: column; position: relative; }
        .top-bar { height: 70px; background: var(--bg-main); display: flex; align-items: center; justify-content: space-between; padding: 0 40px; border-bottom: 1px solid #2f4553; }
        .wallet-display { background: var(--bg-sidebar); padding: 10px 20px; border-radius: 5px; color: var(--white); font-weight: bold; border: 1px solid #2f4553; display: flex; gap: 10px; }

        /* --- SISTEMA DE VISTAS (Lobby vs Juegos) --- */
        .view { display: none; padding: 40px; flex: 1; overflow-y: auto; }
        .view.active { display: block; }

        /* --- ESTILO DE LOS JUEGOS --- */
        .game-wrapper { background: var(--bg-sidebar); border-radius: 10px; display: flex; width: 100%; max-width: 950px; height: 550px; margin: auto; overflow: hidden; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
        .bet-side { width: 300px; padding: 25px; border-right: 1px solid #2f4553; }
        .visual-side { flex: 1; background: var(--bg-main); display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; }
        
        /* Grid de Minas */
        .mines-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; }
        .cell { width: 75px; height: 75px; background: var(--bg-card); border-radius: 5px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 2rem; border-bottom: 4px solid #101e26; }
        
        /* Bloqueo Anti-Trampa */
        #anti-cheat { position: fixed; inset: 0; background: rgba(15,33,46,0.98); z-index: 9999; display: none; align-items: center; justify-content: center; text-align: center; }
        
        .btn-bet { background: var(--accent); color: #01080e; width: 100%; padding: 15px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; font-family: 'Orbitron'; margin-top: 10px; }
        .input-dark { background: var(--bg-main); border: 2px solid #2f4553; color: white; width: 100%; padding: 12px; border-radius: 5px; margin-bottom: 15px; outline: none; }
    </style>
</head>
<body>

<div id="anti-cheat">
    <div style="background:var(--bg-sidebar); padding:50px; border-radius:20px; border:2px solid var(--lose);">
        <h1 style="color:var(--lose)">TIRADAS AGOTADAS</h1>
        <p>Has usado tus 3 intentos gratis. Deposita para continuar.</p>
        <button class="btn-bet" onclick="window.open('https://wa.me/593987749885')">RECARGAR POR WHATSAPP</button>
    </div>
</div>

<aside class="sidebar">
    <div class="logo-area">SMAL STAKE</div>
    <div class="nav-group">
        <div class="nav-item active" onclick="showView('lobby')">üè† Lobby</div>
        <div class="nav-title">Juegos Originales</div>
        <div class="nav-item" onclick="showView('mines')">üí£ Minas</div>
        <div class="nav-item" onclick="showView('crash')">üöÄ Crash</div>
        <div class="nav-item" onclick="showView('tower')">üè∞ Tower</div>
        <div class="nav-item" onclick="showView('slots')">üé∞ Slots</div>
        <div class="nav-item" onclick="resetAdmin()" style="margin-top:20px; color:var(--accent)">üîë Reset (Admin)</div>
    </div>
</aside>

<main class="main">
    <div class="top-bar">
        <div id="current-title" style="color:white; font-weight:bold; font-size:1.2rem;">LOBBY</div>
        <div class="wallet-display">ü™ô <span id="balance">15.00</span></div>
    </div>

    <div id="view-lobby" class="view active">
        <h2>Bienvenido, elige un juego:</h2>
        <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap:20px;">
            <div style="background:var(--bg-sidebar); padding:30px; border-radius:15px; text-align:center; cursor:pointer;" onclick="showView('mines')">üí£<br>MINAS</div>
            <div style="background:var(--bg-sidebar); padding:30px; border-radius:15px; text-align:center; cursor:pointer;" onclick="showView('crash')">üöÄ<br>CRASH</div>
        </div>
    </div>

    <div id="view-mines" class="view">
        <div class="game-wrapper">
            <div class="bet-side">
                <label>Monto de Apuesta</label>
                <input type="number" class="input-dark" value="5">
                <label>Minas (1-24)</label>
                <input type="number" id="mine-count" class="input-dark" value="3">
                <button class="btn-bet" id="btn-mines-start" onclick="startMines()">APOSTAR</button>
                <button class="btn-bet" id="btn-mines-cash" style="display:none; background:#ffcc00;" onclick="cashoutMines()">RETIRAR</button>
            </div>
            <div class="visual-side">
                <div class="mines-grid" id="mines-grid"></div>
            </div>
        </div>
    </div>

    <div id="view-crash" class="view">
        <div class="game-wrapper">
            <div class="bet-side">
                <label>Monto de Apuesta</label>
                <input type="number" class="input-dark" value="5">
                <button class="btn-bet" id="btn-crash-start" onclick="startCrash()">APOSTAR</button>
                <button class="btn-bet" id="btn-crash-cash" style="display:none; background:#ffcc00;" onclick="cashoutCrash()">RETIRAR</button>
            </div>
            <div class="visual-side" id="crash-screen">
                <h1 style="font-size:5rem; color:var(--accent)" id="crash-mult">1.00x</h1>
                <p>üöÄ EL COHETE EST√Å VOLANDO...</p>
            </div>
        </div>
    </div>
</main>

<script>
    let balance = localStorage.getItem('smal_bal') ? parseFloat(localStorage.getItem('smal_bal')) : 15.0;
    let playing = false;
    let minesArr = [];
    let crashInt;
    let currentMult = 1.0;

    function updateUI() {
        document.getElementById('balance').innerText = balance.toFixed(2);
        localStorage.setItem('smal_bal', balance);
        if(balance < 5 && !playing) document.getElementById('anti-cheat').style.display = 'flex';
    }

    function showView(viewName) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById('view-' + viewName).classList.add('active');
        document.getElementById('current-title').innerText = viewName.toUpperCase();
        if(viewName === 'mines') createMinesGrid();
    }

    /* --- L√ìGICA MINAS --- */
    function createMinesGrid() {
        const grid = document.getElementById('mines-grid');
        grid.innerHTML = '';
        for(let i=0; i<25; i++) {
            let c = document.createElement('div');
            c.className = 'cell';
            c.onclick = () => revealMine(c, i);
            grid.appendChild(c);
        }
    }

    function startMines() {
        if(balance < 5) return;
        balance -= 5; updateUI();
        playing = true;
        minesArr = [];
        let count = document.getElementById('mine-count').value;
        while(minesArr.length < count) {
            let r = Math.floor(Math.random() * 25);
            if(!minesArr.includes(r)) minesArr.push(r);
        }
        document.getElementById('btn-mines-start').style.display = 'none';
        document.getElementById('btn-mines-cash').style.display = 'block';
        createMinesGrid();
    }

    function revealMine(el, i) {
        if(!playing || el.innerHTML !== '') return;
        if(minesArr.includes(i)) {
            el.innerHTML = 'üí£'; el.style.background = 'var(--lose)';
            playing = false; setTimeout(() => { alert("BOOM!"); resetMines(); }, 500);
        } else {
            el.innerHTML = 'üíé'; el.style.background = 'var(--accent)';
        }
    }

    function cashoutMines() {
        balance += 12; alert("üí∞ Ganaste 12 Tokens"); resetMines();
    }

    function resetMines() {
        playing = false;
        document.getElementById('btn-mines-start').style.display = 'block';
        document.getElementById('btn-mines-cash').style.display = 'none';
        updateUI();
    }

    /* --- L√ìGICA CRASH --- */
    function startCrash() {
        if(balance < 5) return;
        balance -= 5; updateUI();
        playing = true; currentMult = 1.0;
        document.getElementById('btn-crash-start').style.display = 'none';
        document.getElementById('btn-crash-cash').style.display = 'block';
        
        crashInt = setInterval(() => {
            currentMult += 0.05;
            document.getElementById('crash-mult').innerText = currentMult.toFixed(2) + "x";
            if(Math.random() < 0.03) {
                clearInterval(crashInt);
                document.getElementById('crash-mult').style.color = 'var(--lose)';
                document.getElementById('crash-mult').innerText = "EXPLOT√ì!";
                playing = false;
                setTimeout(() => { resetCrash(); }, 1500);
            }
        }, 100);
    }

    function cashoutCrash() {
        if(!playing) return;
        clearInterval(crashInt);
        let win = 5 * currentMult;
        balance += win;
        alert("üí∞ Retiraste " + win.toFixed(2));
        resetCrash();
    }

    function resetCrash() {
        playing = false;
        document.getElementById('btn-crash-start').style.display = 'block';
        document.getElementById('btn-crash-cash').style.display = 'none';
        document.getElementById('crash-mult').style.color = 'var(--accent)';
        updateUI();
    }

    function resetAdmin() {
        localStorage.clear();
        location.reload();
    }

    updateUI();
</script>
</body>
</html>
