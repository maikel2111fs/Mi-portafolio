<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>SMAL STAKE</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

<style>
:root{
--bg:#0f172a;--panel:#111827;--card:#1f2933;
--accent:#22c55e;--gold:#facc15;
--text:#e5e7eb;--dim:#94a3b8;--red:#ef4444;
}
*{box-sizing:border-box;font-family:'Inter',sans-serif}
body{margin:0;background:var(--bg);color:var(--text);display:flex;height:100vh}
.sidebar{width:240px;background:var(--panel);padding:20px}
.main{flex:1;padding:30px;overflow:auto}
h1,h2{margin:0 0 15px}
.card{background:var(--card);border-radius:14px;padding:20px;margin-bottom:15px}
.btn{padding:10px 16px;border:none;border-radius:8px;font-weight:700;cursor:pointer}
.green{background:var(--accent);color:#000}
.gold{background:var(--gold);color:#000}
.red{background:var(--red);color:#000}
input,select{width:100%;padding:10px;border-radius:8px;border:none;background:#020617;color:#fff;margin-bottom:10px}
.nav div{padding:10px;color:var(--dim);cursor:pointer}
.nav div:hover{color:var(--accent)}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:15px}
.hidden{display:none}
.mine{width:52px;height:52px;background:#020617;border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:800;cursor:pointer}
.mine.safe{background:var(--accent);color:#000}
.mine.bomb{background:var(--red)}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="auth" style="position:fixed;inset:0;background:#020617;display:flex;align-items:center;justify-content:center;z-index:99">
<div class="card" style="width:340px;text-align:center">
<h2 style="color:var(--accent)">SMAL STAKE</h2>
<input id="user" placeholder="Usuario">
<input id="pass" type="password" placeholder="ContraseÃ±a">
<button class="btn green" onclick="login()">Entrar</button>
<button class="btn gold" onclick="register()">Registrar</button>
</div>
</div>

<!-- SIDEBAR -->
<div class="sidebar">
<h2>SMAL</h2>
<p id="uinfo"></p>
<p>ðŸ’° <span id="ubal">0</span></p>
<div class="nav">
<div onclick="view('games')">ðŸŽ° Juegos</div>
<div onclick="view('boxes')">ðŸ“¦ Cajas</div>
<div onclick="view('shop')">ðŸ›’ Tienda</div>
<div onclick="view('inv')">ðŸŽ’ Inventario</div>
<div id="adminBtn" onclick="view('admin')" class="hidden">ðŸ›  Admin</div>
</div>
</div>

<!-- MAIN -->
<div class="main">

<!-- GAMES -->
<div id="games">
<h1>Juegos</h1>
<div class="grid">
<div class="card"><h3>Slots</h3><button class="btn green" onclick="slots()">Jugar</button></div>
<div class="card"><h3>Plinko</h3><button class="btn green" onclick="plinko()">Jugar</button></div>
<div class="card"><h3>Mines</h3><button class="btn green" onclick="mines()">Jugar</button></div>
</div>
<div id="gameArea"></div>
</div>

<!-- BOXES -->
<div id="boxes" class="hidden">
<h1>Cajas</h1>
<div id="boxList" class="grid"></div>
</div>

<!-- SHOP -->
<div id="shop" class="hidden">
<h1>Tienda</h1>
<div id="shopList" class="grid"></div>
</div>

<!-- INVENTORY -->
<div id="inv" class="hidden">
<h1>Inventario</h1>
<div id="invList" class="grid"></div>
</div>

<!-- ADMIN -->
<div id="admin" class="hidden">
<h1 style="color:var(--gold)">Admin</h1>

<div class="card">
<h3>Nueva Caja</h3>
<input id="bname" placeholder="Nombre">
<input id="bprice" type="number" placeholder="Precio">
<input id="bitems" placeholder="Premios (coma)">
<button class="btn green" onclick="createBox()">Crear</button>
</div>

<div class="card">
<h3>Nuevo Producto</h3>
<input id="sname" placeholder="Nombre">
<input id="sprice" type="number" placeholder="Precio">
<input id="sreward" type="number" placeholder="Tokens">
<button class="btn gold" onclick="createShop()">Crear</button>
</div>
</div>

</div>

<script>
let db=JSON.parse(localStorage.getItem("smalStake"))||{users:{},boxes:[],shop:[]};
let current=null;

function save(){localStorage.setItem("smalStake",JSON.stringify(db));}

function register(){
if(db.users[user.value])return alert("Existe");
db.users[user.value]={pass:pass.value,bal:100,inv:[],role:user.value==="admin"?"admin":"user"};
save();alert("Creado");
}

function login(){
let u=db.users[user.value];
if(!u||u.pass!==pass.value)return alert("Error");
current=user.value;sessionStorage.setItem("u",current);init();
}

function init(){
current=sessionStorage.getItem("u");if(!current)return;
auth.style.display="none";
let u=db.users[current];
uinfo.innerText=current;
ubal.innerText=u.bal;
if(u.role==="admin")adminBtn.classList.remove("hidden");
render();
}

function view(v){
["games","boxes","shop","inv","admin"].forEach(x=>document.getElementById(x).classList.add("hidden"));
document.getElementById(v).classList.remove("hidden");
}

function render(){renderBoxes();renderShop();renderInv();ubal.innerText=db.users[current].bal;save();}

function slots(){
let u=db.users[current];if(u.bal<10)return;
u.bal-=10;
let r=Math.random();
if(r<0.03)u.bal+=200;
else if(r<0.15)u.bal+=30;
alert("Spin terminado");
render();
}

function plinko(){
let u=db.users[current];if(u.bal<5)return;
u.bal-=5;
let mult=[0,0.5,1,2,5][Math.floor(Math.random()*5)];
u.bal+=5*mult;
alert("x"+mult);
render();
}

function mines(){
let u=db.users[current];let area=document.getElementById("gameArea");
area.innerHTML="";let bombs=[Math.floor(Math.random()*25)];
for(let i=0;i<25;i++){
let d=document.createElement("div");d.className="mine";
d.onclick=()=>{if(bombs.includes(i)){d.classList.add("bomb");area.innerHTML="";}
else{d.classList.add("safe");u.bal+=2;render();}};
area.appendChild(d);
}
area.style.display="grid";area.style.gridTemplateColumns="repeat(5,52px)";
}

function createBox(){db.boxes.push({n:bname.value,p:+bprice.value,i:bitems.value.split(",")});render();}
function renderBoxes(){boxList.innerHTML="";db.boxes.forEach((b,i)=>boxList.innerHTML+=`<div class="card"><h3>${b.n}</h3><p>${b.p}</p><button class="btn green" onclick="openBox(${i})">Abrir</button></div>`);}
function openBox(i){let u=db.users[current],b=db.boxes[i];if(u.bal<b.p)return;u.bal-=b.p;let p=b.i[Math.floor(Math.random()*b.i.length)];u.inv.push(p);alert(p);render();}

function createShop(){db.shop.push({n:sname.value,p:+sprice.value,r:+sreward.value});render();}
function renderShop(){shopList.innerHTML="";db.shop.forEach((s,i)=>shopList.innerHTML+=`<div class="card"><h3>${s.n}</h3><p>${s.p}</p><button class="btn gold" onclick="buy(${i})">Comprar</button></div>`);}
function buy(i){db.users[current].bal+=db.shop[i].r;render();}

function renderInv(){invList.innerHTML="";db.users[current].inv.forEach(x=>invList.innerHTML+=`<div class="card">${x}</div>`);}

init();
</script>
</body>
</html>
