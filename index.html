<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMAL EMPIRE | CASINO PROFESIONAL</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --bg: #020609; --card: #0b1218; --accent: #00e701; --gold: #f5d033;
            --text: #ffffff; --text-dim: #94a3b8; --border: #1e293b; --danger: #ff4757;
        }
        * { box-sizing: border-box; font-family: 'Plus Jakarta Sans', sans-serif; transition: 0.2s; }
        body { background: var(--bg); color: var(--text); margin: 0; overflow: hidden; display: flex; height: 100vh; }

        /* --- SIDEBAR --- */
        .sidebar { width: 280px; background: var(--card); border-right: 1px solid var(--border); display: flex; flex-direction: column; z-index: 100; }
        .nav-item { padding: 16px 25px; cursor: pointer; color: var(--text-dim); display: flex; align-items: center; gap: 12px; font-weight: 600; border-left: 4px solid transparent; }
        .nav-item:hover, .nav-item.active { background: #16212c; color: var(--accent); border-left-color: var(--accent); }

        /* --- MAIN --- */
        .main { flex: 1; overflow-y: auto; padding: 30px; position: relative; }
        .view { display: none; animation: fadeIn 0.4s ease; max-width: 1200px; margin: 0 auto; }
        .view.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- UI ELEMENTS --- */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 20px; }
        .card { background: #16212c; border-radius: 16px; padding: 20px; border: 1px solid var(--border); text-align: center; position: relative; }
        .btn { padding: 12px 20px; border: none; border-radius: 8px; font-weight: 800; cursor: pointer; width: 100%; margin-top: 10px; text-transform: uppercase; }
        .btn-main { background: var(--accent); color: black; }
        .btn-gold { background: var(--gold); color: black; }
        .free-badge { position: absolute; top: 10px; right: 10px; background: var(--danger); color: white; padding: 4px 8px; border-radius: 5px; font-size: 0.7rem; font-weight: 800; }

        /* --- AUTH & RULES --- */
        #auth-overlay { position: fixed; inset: 0; background: var(--bg); z-index: 5000; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(10px); }
        .welcome-card { background: var(--card); padding: 40px; border-radius: 24px; width: 90%; max-width: 500px; border: 1px solid var(--accent); text-align: center; }
        
        input, textarea { width: 100%; padding: 12px; margin-bottom: 10px; border-radius: 8px; background: #000; color: #fff; border: 1px solid var(--border); outline: none; }

        /* --- GAME ENGINE --- */
        .game-window { background: #070d14; border: 2px solid var(--border); border-radius: 20px; padding: 40px; margin-top: 20px; text-align: center; }
    </style>
</head>
<body>

<div id="auth-overlay">
    <div class="welcome-card" id="step-1">
        <h1 style="font-family:'Orbitron'; color:var(--accent); letter-spacing: 5px;">SMAL EMPIRE</h1>
        <div style="text-align: left; background: #000; padding: 20px; border-radius: 12px; font-size: 0.85rem; height: 250px; overflow-y: auto; margin: 20px 0; border: 1px solid #1e293b;">
            <h3 style="color:var(--gold)">üìú REGLAS DEL CASINO</h3>
            <p>1. <b>1 USD = 10 Tokens.</b> Recargas v√≠a PayPal.</p>
            <p>2. <b>PRUEBA GRATIS:</b> Cada usuario tiene 3 tiradas de cortes√≠a.</p>
            <p>3. <b>RECLAMOS:</b> Los premios se env√≠an a tu WhatsApp o Gmail. Al reclamar, el objeto se destruye de tu mochila.</p>
            <p>4. <b>SOPORTE:</b> WhatsApp oficial: +593987749885.</p>
            <p>5. No se permite el uso de m√∫ltiples cuentas por IP.</p>
        </div>
        <button class="btn btn-main" onclick="next()">ACEPTAR Y CONTINUAR</button>
    </div>

    <div class="welcome-card" id="step-2" style="display:none">
        <h1 style="font-family:'Orbitron';">TU IDENTIDAD</h1>
        <input type="text" id="in-user" placeholder="Nombre de usuario">
        <p style="font-size: 0.8rem; color: var(--text-dim);">Este nombre se usar√° para tus premios.</p>
        <button class="btn btn-main" onclick="initEmpire()">ENTRAR AL CASINO</button>
    </div>
</div>

<aside class="sidebar">
    <div style="padding: 30px; text-align: center;">
        <div id="u-initial" style="width:60px; height:60px; background:var(--accent); color:black; border-radius:15px; display:flex; align-items:center; justify-content:center; margin: 0 auto 10px; font-weight:900; font-size:1.5rem;">?</div>
        <h3 id="u-display-name" style="margin:0;">-</h3>
        <div style="color:var(--gold); font-weight:800; font-size:1.1rem; margin-top:5px;">ü™ô <span id="u-bal">0.00</span></div>
        <div id="free-spins-count" style="font-size:0.7rem; color:var(--danger); margin-top:5px; font-weight:800;">TIRADAS GRATIS: 3</div>
    </div>
    <nav id="side-menu">
        <div class="nav-item active" onclick="nav('home')">üè† Inicio</div>
        <div class="nav-item" onclick="nav('games')">üéÆ Sala de Juegos (10)</div>
        <div class="nav-item" onclick="nav('boxes')">üì¶ Mystery Boxes</div>
        <div class="nav-item" onclick="nav('shop')">üõí Tienda de Canje</div>
        <div class="nav-item" onclick="nav('inv')">üéí Mi Mochila</div>
        <div class="nav-item" id="adm-link" style="display:none; color:var(--gold)" onclick="nav('admin')">üõ† PANEL MAESTRO</div>
    </nav>
</aside>

<main class="main">
    <div id="v-home" class="view active">
        <h1 style="font-family:'Orbitron';">EL <span style="color:var(--accent)">IMPERIO</span> EST√Å LISTO</h1>
        <div class="grid">
            <div class="card"><h3>Bienvenida</h3><p>Recuerda que tienes 3 tiros gratis para probar suerte.</p></div>
            <div class="card"><h3>Soporte 24/7</h3><p>WhatsApp: +593987749885</p></div>
        </div>
        <div id="dynamic-content-area" style="margin-top:30px;"></div>
    </div>

    <div id="v-games" class="view">
        <div class="grid">
            <div class="card" onclick="openGame('MINAS')">üí£ Minas Elite</div>
            <div class="card" onclick="openGame('CRASH')">üöÄ Space Crash</div>
            <div class="card" onclick="openGame('COIN')">ü™ô Coinflip 50/50</div>
            <div class="card" onclick="openGame('DICE')">üé≤ Dados Reales</div>
            <div class="card" onclick="openGame('RULETA')">üé° Ruleta Smal</div>
            <div class="card" onclick="openGame('SLOTS')">üé∞ Super Slots</div>
            <div class="card" onclick="openGame('PLINKO')">üîµ Plinko Drop</div>
            <div class="card" onclick="openGame('BLACKJACK')">üÉè Blackjack 21</div>
            <div class="card" onclick="openGame('TOWER')">üóº Tower Climb</div>
            <div class="card" onclick="openGame('WHEEL')">üé° Wheel of Fortune</div>
        </div>
        <div id="game-engine" class="game-window" style="display:none">
            <h2 id="g-title" style="color:var(--accent)">-</h2>
            <div id="g-play-area"></div>
            <button class="btn btn-gold" style="width:200px" onclick="closeGame()">SALIR DEL JUEGO</button>
        </div>
    </div>

    <div id="v-shop" class="view">
        <h1>Tienda de Canje</h1>
        <div class="grid" id="shop-items"></div>
    </div>

    <div id="v-inv" class="view">
        <h1>Mi Mochila</h1>
        <div class="grid" id="inv-items"></div>
    </div>

    <div id="v-admin" class="view">
        <h1 style="color:var(--gold)">PANEL MAESTRO</h1>
        <div class="grid">
            <div class="card">
                <h3>Crear Nueva P√°gina</h3>
                <input type="text" id="adm-p-n" placeholder="T√≠tulo Men√∫">
                <textarea id="adm-p-c" placeholder="Contenido HTML" rows="5"></textarea>
                <button class="btn btn-main" onclick="adminAddPage()">PUBLICAR P√ÅGINA</button>
            </div>
            <div class="card">
                <h3>A√±adir a Tienda</h3>
                <input type="text" id="adm-s-n" placeholder="Nombre Item">
                <input type="number" id="adm-s-p" placeholder="Costo en Tokens">
                <button class="btn btn-gold" onclick="adminAddShop()">SUBIR A TIENDA</button>
            </div>
        </div>
    </div>
</main>

<script>
    // --- L√ìGICA DE PERSISTENCIA Y ESTADO ---
    let state = JSON.parse(localStorage.getItem('smal_pro_v1')) || {
        u: "", bal: 0, free: 3, inv: [], 
        pages: [], 
        shop: [{n: "Skin M√≠tica", p: 100}, {n: "Rango Admin", p: 500}]
    };

    function save() { localStorage.setItem('smal_pro_v1', JSON.stringify(state)); }

    function next() { document.getElementById('step-1').style.display='none'; document.getElementById('step-2').style.display='block'; }

    function initEmpire() {
        let name = document.getElementById('in-user').value;
        if(!name) return alert("Pon un nombre");
        state.u = name;
        if(name === "SmalAdmin") document.getElementById('adm-link').style.display = 'flex';
        document.getElementById('auth-overlay').style.display = 'none';
        document.getElementById('u-display-name').innerText = state.u;
        document.getElementById('u-initial').innerText = state.u[0].toUpperCase();
        refreshUI();
        loadPages();
    }

    function refreshUI() {
        document.getElementById('u-bal').innerText = state.bal.toFixed(2);
        document.getElementById('free-spins-count').innerText = "TIRADAS GRATIS: " + state.free;
        save();
    }

    function nav(id) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById('v-' + id).classList.add('active');
        if(id === 'shop') renderShop();
        if(id === 'inv') renderInv();
    }

    // --- MOTOR DE JUEGOS Y L√ìGICA DE TIRADAS ---
    function openGame(name) {
        if(state.free <= 0 && state.bal < 10) {
            return alert("‚ùå ¬°Sin energ√≠a! Recarga Tokens v√≠a PayPal para seguir jugando.");
        }
        
        document.getElementById('game-engine').style.display = 'block';
        document.getElementById('g-title').innerText = name;
        
        let cost = 0;
        if(state.free > 0) {
            state.free--;
            alert("üé∞ Usando 1 de tus 3 tiradas GRATIS...");
        } else {
            state.bal -= 10;
            cost = 10;
        }
        refreshUI();

        // SIMULADOR DE JUEGO FUNCIONAL (MINAS/RULETA/ETC)
        document.getElementById('g-play-area').innerHTML = `
            <div style="padding:20px;">
                <h3 id="game-status">Apostaste 10 Tokens... Girando...</h3>
                <div id="game-visual" style="font-size:3rem; margin:20px 0;">üé≤</div>
                <button class="btn btn-main" id="btn-play-action" onclick="processGameResult()">¬øQU√â SALI√ì?</button>
            </div>
        `;
    }

    function processGameResult() {
        let win = Math.random() > 0.6; // 40% de probabilidad de ganar
        let visual = document.getElementById('game-visual');
        let status = document.getElementById('game-status');
        
        if(win) {
            state.bal += 25;
            visual.innerText = "üí∞";
            status.innerText = "¬°GANASTE 25 TOKENS!";
            confetti();
        } else {
            visual.innerText = "üíÄ";
            status.innerText = "PERDISTE... Int√©ntalo de nuevo.";
        }
        document.getElementById('btn-play-action').style.display = 'none';
        refreshUI();
    }

    function closeGame() { document.getElementById('game-engine').style.display = 'none'; }

    // --- TIENDA Y CANJES ---
    function renderShop() {
        const container = document.getElementById('shop-items');
        container.innerHTML = "";
        state.shop.forEach(item => {
            container.innerHTML += `
                <div class="card">
                    <h3>${item.n}</h3>
                    <p style="color:var(--gold)">${item.p} TOKENS</p>
                    <button class="btn btn-main" onclick="buyItem('${item.n}', ${item.p})">CANJEAR</button>
                </div>`;
        });
    }

    function buyItem(n, p) {
        if(state.bal < p) return alert("Saldo insuficiente.");
        state.bal -= p;
        state.inv.push(n);
        refreshUI();
        alert("¬°Item comprado! Revisa tu mochila.");
    }

    // --- INVENTARIO Y ELIMINACI√ìN AL RECLAMAR ---
    function renderInv() {
        const container = document.getElementById('inv-items');
        container.innerHTML = state.inv.length === 0 ? "Vac√≠o" : "";
        state.inv.forEach((item, idx) => {
            container.innerHTML += `
                <div class="card">
                    <h3>${item}</h3>
                    <button class="btn btn-gold" onclick="claimFinal('${item}', ${idx})">RECLAMAR AL GMAIL/WHATSAPP</button>
                </div>`;
        });
    }

    function claimFinal(item, idx) {
        // Enviar a WhatsApp configurado
        let msg = encodeURIComponent(`Hola Smal Empire, soy ${state.u} y reclamo mi premio: ${item}`);
        window.open(`https://wa.me/593987749885?text=${msg}`);
        
        // ELIMINAR AUTOM√ÅTICAMENTE DEL INVENTARIO
        state.inv.splice(idx, 1);
        save();
        renderInv();
        alert("¬°Solicitud enviada! El item ha sido removido de tu inventario.");
    }

    // --- ADMIN: CREAR P√ÅGINAS ---
    function adminAddPage() {
        let n = document.getElementById('adm-p-n').value;
        let c = document.getElementById('adm-p-c').value;
        if(!n || !c) return;
        state.pages.push({n, c});
        save();
        alert("P√°gina publicada. Aparecer√° en el men√∫.");
        loadPages();
    }

    function loadPages() {
        const menu = document.getElementById('side-menu');
        // Limpiar botones din√°micos previos
        document.querySelectorAll('.dyn-nav').forEach(e => e.remove());
        
        state.pages.forEach(p => {
            let d = document.createElement('div');
            d.className = "nav-item dyn-nav";
            d.innerHTML = `üìÑ ${p.n}`;
            d.onclick = () => {
                nav('home');
                document.getElementById('v-home').innerHTML = p.c;
            };
            menu.appendChild(d);
        });
    }
</script>
</body>
</html>
