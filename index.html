<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Smal Casino | El Imperio</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Orbitron:wght@700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0f212e; --side: #1a2c38; --card: #213743;
            --accent: #00e701; --gold: #ffcc00; --text: #b1bad3;
            --white: #ffffff; --border: #2f4553; --win: #00e701; --lose: #ff3366;
        }
        * { box-sizing: border-box; font-family: 'Inter', sans-serif; transition: 0.2s; }
        body { background: var(--bg); color: var(--text); margin: 0; display: flex; height: 100vh; overflow: hidden; }

        /* --- AUTH SYSTEM --- */
        #auth-overlay { position: fixed; inset: 0; background: var(--bg); z-index: 10000; display: flex; align-items: center; justify-content: center; background-image: radial-gradient(circle, #1a2c38 10%, #0f212e 100%); }
        .auth-card { background: var(--side); padding: 40px; border-radius: 12px; width: 450px; border: 1px solid var(--accent); text-align: center; box-shadow: 0 0 30px rgba(0,231,1,0.2); }
        .auth-tabs { display: flex; gap: 10px; margin-bottom: 20px; background: var(--bg); padding: 5px; border-radius: 50px; }
        .tab { flex: 1; padding: 10px; cursor: pointer; border-radius: 50px; font-weight: bold; color: var(--text); }
        .tab.active { background: var(--card); color: white; }

        /* --- LAYOUT --- */
        .sidebar { width: 260px; background: var(--side); border-right: 1px solid var(--border); display: flex; flex-direction: column; }
        .main { flex: 1; display: flex; flex-direction: column; overflow-y: auto; position: relative; background: #071620; }
        .navbar { height: 65px; background: var(--side); display: flex; align-items: center; justify-content: space-between; padding: 0 25px; border-bottom: 1px solid var(--border); }
        
        /* --- CHAT GLOBAL --- */
        .chat-panel { width: 300px; background: var(--side); border-left: 1px solid var(--border); display: flex; flex-direction: column; }
        #chat-messages { flex: 1; overflow-y: auto; padding: 15px; font-size: 0.85rem; }
        .chat-msg { margin-bottom: 10px; background: var(--card); padding: 8px; border-radius: 5px; border-left: 3px solid var(--accent); }
        .chat-msg b { color: var(--white); display: block; font-size: 0.7rem; }

        /* --- VIEWS --- */
        .view { padding: 30px; display: none; animation: fadeIn 0.4s; }
        .view.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- GRID & CARDS --- */
        .grid-games { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; }
        .game-card { background: var(--card); border-radius: 12px; padding: 25px; text-align: center; cursor: pointer; border: 1px solid transparent; position: relative; overflow: hidden; }
        .game-card:hover { border-color: var(--accent); transform: scale(1.03); background: #2a414d; }
        .game-card i { font-size: 2.5rem; display: block; margin-bottom: 10px; }

        /* --- BUTTONS --- */
        .btn-main { background: var(--accent); color: black; border: none; padding: 14px; border-radius: 6px; font-weight: 900; cursor: pointer; width: 100%; text-transform: uppercase; letter-spacing: 1px; }
        .btn-gold { background: var(--gold); color: black; border: none; padding: 14px; border-radius: 6px; font-weight: 900; cursor: pointer; width: 100%; }
        
        /* --- PROFILE & WALLET --- */
        .profile-section { padding: 20px; border-bottom: 1px solid var(--border); text-align: center; }
        .avatar { width: 60px; height: 60px; background: var(--accent); border-radius: 50%; margin: 0 auto 10px; line-height: 60px; color: black; font-weight: bold; font-size: 1.5rem; }
        .wallet-box { background: var(--bg); padding: 10px 20px; border-radius: 8px; border: 1px solid var(--border); color: var(--white); font-weight: 800; display: flex; gap: 10px; align-items: center; }

        /* --- LUCKYBLOCKS --- */
        .lucky-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-top: 20px; }
        .lucky-cube { background: var(--gold); height: 100px; border-radius: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 3rem; box-shadow: 0 5px 0 #b89600; }
        .lucky-cube:active { transform: translateY(5px); box-shadow: none; }

    </style>
</head>
<body>

<div id="auth-overlay">
    <div class="auth-card">
        <h1 style="font-family:'Orbitron'; color:white; letter-spacing: 5px;">SMAL CASINO</h1>
        <div class="auth-tabs">
            <div id="tab-log" class="tab active" onclick="setAuth('login')">INICIAR</div>
            <div id="tab-reg" class="tab" onclick="setAuth('reg')">REGISTRAR</div>
        </div>
        <input type="text" id="auth-u" placeholder="Usuario">
        <input type="password" id="auth-p" placeholder="Contrase√±a o Admin Key">
        <div style="font-size:0.75rem; text-align:left; color:#557086; margin-bottom: 15px;">
            <input type="checkbox" id="auth-terms"> Acepto que <b>no hay reembolsos</b> y que todo premio se reclama a +593987749885.
        </div>
        <button class="btn-main" onclick="handleAuth()">INGRESAR AL IMPERIO</button>
    </div>
</div>

<aside class="sidebar">
    <div class="profile-section">
        <div class="avatar" id="u-avatar">?</div>
        <div id="u-name" style="color:white; font-weight:bold; font-size: 1.1rem;">Invitado</div>
        <div style="color:var(--accent); font-size:0.7rem; font-weight:bold;">NIVEL ELITE</div>
    </div>
    <div style="flex:1">
        <div class="nav-item" onclick="nav('lobby')" style="padding:15px 25px; cursor:pointer;">üè† Inicio</div>
        <div class="nav-item" onclick="nav('games')" style="padding:15px 25px; cursor:pointer;">üéÆ 10 Juegos Pro</div>
        <div class="nav-item" onclick="nav('lucky')" style="padding:15px 25px; cursor:pointer;">üéÅ LuckyBlocks</div>
        <div class="nav-item" onclick="nav('shop')" style="padding:15px 25px; cursor:pointer;">üõí Tienda / Trades</div>
        <div class="nav-item" onclick="nav('inv')" style="padding:15px 25px; cursor:pointer;">üéí Mi Inventario</div>
    </div>
    <div id="admin-btn" onclick="nav('admin')" style="display:none; padding:20px; background:var(--gold); color:black; font-weight:bold; cursor:pointer; text-align:center;">üõ† PANEL MAESTRO</div>
</aside>

<main class="main">
    <nav class="navbar">
        <div style="font-weight:900; color:white; font-family:'Orbitron';">IMPERIO SMAL</div>
        <div class="wallet-box">ü™ô <span id="u-bal">0.00</span></div>
    </nav>

    <div id="v-lobby" class="view active">
        <h1>¬°Bienvenido Jefe!</h1>
        <p>Tienes <b id="u-spins">0</b> Tiros Gratis de bienvenida.</p>
        <div class="grid-games">
            <div class="game-card" onclick="nav('games')"><h3>MINAS PRO</h3><p>Gana f√°cil con multiplicador</p></div>
            <div class="game-card" style="background:var(--gold); color:black;" onclick="nav('lucky')"><h3>LUCKYBLOCKS</h3><p>Abre cajas editables</p></div>
            <div class="game-card" onclick="nav('shop')"><h3>TRADES</h3><p>Intercambia con amigos</p></div>
        </div>
    </div>

    <div id="v-games" class="view">
        <h2>Originales de Smal (10 Juegos)</h2>
        <div class="grid-games">
            <div class="game-card" onclick="alert('Minas: Busca los diamantes y evita las bombas.')">üí£ Minas</div>
            <div class="game-card" onclick="alert('Crash: El multiplicador sube, ¬°retira antes de que explote!')">üöÄ Crash</div>
            <div class="game-card" onclick="alert('Coinflip: Apuesta Cara o Cruz contra otro jugador.')">ü™ô Coinflip</div>
            <div class="game-card" onclick="alert('Plinko: Suelta la bola y gana seg√∫n donde caiga.')">‚ö™ Plinko</div>
            <div class="game-card" onclick="alert('Dice: Elige un n√∫mero y tira el dado.')">üé≤ Dice</div>
            <div class="game-card" onclick="alert('Limbo: El multiplicador infinito.')">üåà Limbo</div>
            <div class="game-card" onclick="alert('Rueda: Gira la rueda de la fortuna.')">üé° Wheel</div>
            <div class="game-card" onclick="alert('Slots: Tres figuras iguales ganan el jackpot.')">üé∞ Slots</div>
            <div class="game-card" onclick="alert('Torre: Sube pisos sin tocar la trampa.')">üè∞ Tower</div>
            <div class="game-card" onclick="alert('Diamantes: El juego de cartas de Smal.')">üíé Diamonds</div>
        </div>
    </div>

    <div id="v-lucky" class="view">
        <h2>üéÅ LuckyBlocks (Cajas de Premios)</h2>
        <p>Costo por apertura: <b id="lb-cost-display">50</b> Tokens</p>
        <div class="lucky-grid" id="lb-grid">
            </div>
    </div>

    <div id="v-shop" class="view">
        <h2>üõí Mercado e Intercambios</h2>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:30px;">
            <div class="auth-card" style="width:100%; border-color:var(--gold);">
                <h3>Enviar Solicitud de Trade</h3>
                <input type="text" id="trade-nick" placeholder="Nombre del jugador">
                <button class="btn-gold" onclick="alert('Solicitud enviada a ' + document.getElementById('trade-nick').value)">MANDAR SOLICITUD</button>
            </div>
            <div class="auth-card" style="width:100%;">
                <h3>Tienda de Tokens</h3>
                <div id="shop-items-list">
                    </div>
            </div>
        </div>
    </div>

    <div id="v-inv" class="view">
        <h2>üéí Tu Mochila de Items</h2>
        <div class="grid-games" id="inv-grid"></div>
    </div>

    <div id="v-admin" class="view">
        <h1 style="color:var(--gold)">üõ† PANEL DE CONTROL MAESTRO</h1>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
            <div class="auth-card" style="width:100%;">
                <h3>Editar LuckyBlocks</h3>
                <input type="text" id="adm-box-item" placeholder="Nombre del Premio">
                <input type="number" id="adm-box-prob" placeholder="Probabilidad % (1-100)">
                <input type="number" id="adm-box-price" placeholder="Precio de la Caja">
                <button class="btn-main" onclick="configBox()">GUARDAR CONFIGURACI√ìN</button>
            </div>
            <div class="auth-card" style="width:100%;">
                <h3>Gesti√≥n de Tokens</h3>
                <input type="text" id="adm-user-target" placeholder="Nombre Usuario">
                <input type="number" id="adm-amount" placeholder="Tokens a a√±adir">
                <button class="btn-gold" onclick="addTokensAdmin()">DAR DINERO</button>
            </div>
        </div>
    </div>
</main>

<aside class="chat-panel">
    <div style="padding:20px; border-bottom:1px solid var(--border); color:white; font-weight:bold;">CHAT GLOBAL</div>
    <div id="chat-messages"></div>
    <div style="padding:15px; background:var(--bg);">
        <input type="text" id="chat-in" placeholder="Escribe al imperio..." onkeypress="if(event.key=='Enter') sendChat()">
    </div>
</aside>

<script>
    // --- VARIABLES DE ESTADO ---
    let stats = {
        user: "", balance: 100.0, spins: 3, inv: [], isAdmin: false,
        lbPrice: 50,
        lbPool: [{n: "Rango Bronce", p: 20}, {n: "Bono $5", p: 10}],
        shop: [{n: "Skin Diamante", p: 500}, {n: "Unban Pass", p: 1000}]
    };

    // --- SISTEMA DE SESI√ìN ---
    function handleAuth() {
        let u = document.getElementById('auth-u').value;
        let p = document.getElementById('auth-p').value;
        if(!u || !document.getElementById('auth-terms').checked) return alert("Acepta t√©rminos");

        // CUENTA ADMIN MAESTRO
        if(u === "SmalAdmin" && p === "imperiosmal2026") {
            stats.isAdmin = true;
            stats.user = "SmalAdmin";
        } else {
            let saved = localStorage.getItem('smal_imp_' + u);
            if(saved) stats = JSON.parse(saved);
            else stats.user = u;
        }

        document.getElementById('auth-overlay').style.display = 'none';
        document.getElementById('u-name').innerText = stats.user;
        document.getElementById('u-avatar').innerText = stats.user[0].toUpperCase();
        
        if(stats.isAdmin) document.getElementById('admin-btn').style.display = 'block';
        
        addChat("SISTEMA", "El usuario " + stats.user + " ha entrado al imperio.");
        save();
        updateUI();
    }

    function save() { 
        localStorage.setItem('smal_imp_' + stats.user, JSON.stringify(stats)); 
    }

    function updateUI() {
        document.getElementById('u-bal').innerText = stats.balance.toFixed(2);
        document.getElementById('u-spins').innerText = stats.spins;
        document.getElementById('lb-cost-display').innerText = stats.lbPrice;
        
        // Render LuckyBlocks
        const lbg = document.getElementById('lb-grid'); lbg.innerHTML = '';
        for(let i=0; i<8; i++) lbg.innerHTML += `<div class="lucky-cube" onclick="openBox()">üéÅ</div>`;

        // Render Shop
        const sh = document.getElementById('shop-items-list'); sh.innerHTML = '';
        stats.shop.forEach(it => {
            sh.innerHTML += `<div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                <span>${it.n}</span> <button onclick="buy('${it.n}', ${it.p})" class="btn-gold" style="width:auto; padding:5px 10px;">${it.p} TKN</button>
            </div>`;
        });

        // Render Inventario
        const inv = document.getElementById('inv-grid'); inv.innerHTML = stats.inv.length ? '' : 'Vac√≠o';
        stats.inv.forEach((it, idx) => {
            inv.innerHTML += `<div class="game-card"><b>${it.n}</b><br><button class="btn-main" onclick="claim('${it.n}', ${idx})">RECLAMAR</button></div>`;
        });
    }

    function nav(v) {
        document.querySelectorAll('.view').forEach(x => x.classList.remove('active'));
        document.getElementById('v-' + v).classList.add('active');
    }

    // --- CHAT ---
    function sendChat() {
        let i = document.getElementById('chat-in');
        if(!i.value) return;
        addChat(stats.user, i.value);
        i.value = "";
    }

    function addChat(u, m) {
        let box = document.getElementById('chat-messages');
        let color = u === "SmalAdmin" ? 'var(--gold)' : 'var(--accent)';
        box.innerHTML += `<div class="chat-msg" style="border-color:${color}"><b>${u}</b>${m}</div>`;
        box.scrollTop = box.scrollHeight;
    }

    // --- LUCKYBLOCKS LOGIC ---
    function openBox() {
        if(stats.balance < stats.lbPrice) return alert("Faltan tokens.");
        stats.balance -= stats.lbPrice;
        
        let win = "Basura";
        stats.lbPool.forEach(it => {
            if(Math.random()*100 < it.p) win = it.n;
        });

        if(win !== "Basura") {
            stats.inv.push({n: win, d: new Date().toLocaleDateString()});
            alert("üî• ¬°LUCKY! Ganaste: " + win);
        } else {
            alert("‚òÅÔ∏è Caja vac√≠a...");
        }
        save(); updateUI();
    }

    // --- ADMIN ACTIONS ---
    function configBox() {
        let n = document.getElementById('adm-box-item').value;
        let p = document.getElementById('adm-box-prob').value;
        let c = document.getElementById('adm-box-price').value;
        if(n && p) stats.lbPool.push({n: n, p: parseInt(p)});
        if(c) stats.lbPrice = parseInt(c);
        alert("Configuraci√≥n de Cajas Actualizada");
        save(); updateUI();
    }

    function addTokensAdmin() {
        stats.balance += parseInt(document.getElementById('adm-amount').value);
        save(); updateUI();
    }

    function claim(name, idx) {
        // Simulaci√≥n de env√≠o de Gmail (abre el cliente de correo o WhatsApp)
        window.open(`https://wa.me/593987749885?text=Hola SmalAdmin, soy ${stats.user} y quiero reclamar mi premio: ${name}. Mi ID de cuenta es #${Math.floor(Math.random()*9999)}`);
        stats.inv.splice(idx, 1);
        save(); updateUI();
    }

    function buy(n, p) {
        if(stats.balance < p) return alert("No alcanza");
        stats.balance -= p;
        stats.inv.push({n: n, d: "Comprado"});
        alert("Comprado: " + n);
        save(); updateUI();
    }

</script>
</body>
</html>
