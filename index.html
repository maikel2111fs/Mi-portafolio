<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMAL EMPIRE | MEGA CASINO V12</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <script src="https://www.paypal.com/sdk/js?client-id=AY9cjKW9uJqtsEJeZ6VyY6S-feyCF_30R-DFGd3FH-Ccznh8IXE9lek4MlUTIVWKMkrt0l7-TEgUMYJa&currency=USD"></script>
    <style>
        :root { --bg: #020406; --card: #0d1117; --accent: #00ff59; --gold: #f5d033; --red: #ff4747; --text: #ffffff; --border: #21262d; }
        * { box-sizing: border-box; transition: 0.2s; }
        body { background: var(--bg); color: var(--text); font-family: 'Plus Jakarta Sans', sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* SIDEBAR */
        .sidebar { width: 260px; background: var(--card); border-right: 1px solid var(--border); display: flex; flex-direction: column; z-index: 10; overflow-y: auto; }
        .nav-item { padding: 15px 25px; cursor: pointer; color: #8b949e; font-weight: bold; border-left: 4px solid transparent; display: flex; align-items: center; gap: 10px; }
        .nav-item:hover, .nav-item.active { background: #161b22; color: var(--accent); border-left-color: var(--accent); }

        /* MAIN */
        .main { flex: 1; padding: 30px; overflow-y: auto; background: radial-gradient(circle at top right, #0a1f10, var(--bg)); }
        .view { display: none; max-width: 1000px; margin: 0 auto; }
        .view.active { display: block; animation: slideUp 0.4s ease; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* UI COMPONENTS */
        .glass { background: rgba(255, 255, 255, 0.03); border: 1px solid var(--border); border-radius: 16px; padding: 20px; backdrop-filter: blur(10px); }
        .btn { background: var(--accent); color: #000; border: none; padding: 12px 20px; border-radius: 8px; font-weight: 800; cursor: pointer; text-transform: uppercase; width: 100%; }
        .btn-gold { background: var(--gold); }
        .grid-games { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; }
        
        /* AUTH */
        #auth-screen { position: fixed; inset: 0; background: var(--bg); z-index: 1000; display: flex; align-items: center; justify-content: center; }
        input { background: #000; border: 1px solid var(--border); color: #fff; padding: 12px; border-radius: 8px; width: 100%; margin-bottom: 10px; }

        /* GAMES & BOXES */
        .box-card { text-align: center; border: 2px solid var(--gold); padding: 15px; border-radius: 12px; }
        .item-card { background: #161b22; padding: 10px; border-radius: 8px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
    </style>
</head>
<body>

<div id="auth-screen">
    <div class="glass" style="width: 350px; text-align: center;">
        <h1 style="font-family:'Orbitron'; color:var(--accent)">SMAL EMPIRE</h1>
        <div id="auth-form">
            <input type="text" id="log-user" placeholder="Nombre de Usuario">
            <input type="password" id="log-pass" placeholder="Contrase√±a">
            <button class="btn" onclick="core.handleAuth('login')">INICIAR SESI√ìN</button>
            <button class="btn" style="background:transparent; color:white; margin-top:10px;" onclick="core.handleAuth('reg')">REGISTRARSE</button>
        </div>
    </div>
</div>

<aside class="sidebar">
    <div style="padding:25px; text-align:center; border-bottom: 1px solid var(--border);">
        <div id="u-ava" style="width:60px; height:60px; background:var(--accent); color:black; border-radius:15px; display:flex; align-items:center; justify-content:center; margin:0 auto 10px; font-weight:900; font-size:1.5rem;">?</div>
        <div id="u-name" style="font-weight:800; letter-spacing:1px;">USUARIO</div>
        <div style="color:var(--gold); font-weight:900; font-size:1.4rem;">ü™ô <span id="u-bal">0</span></div>
    </div>
    <nav>
        <div class="nav-item active" onclick="core.nav('lobby')">üè† LOBBY</div>
        <div class="nav-item" onclick="core.nav('games')">üé∞ 10 JUEGOS</div>
        <div class="nav-item" onclick="core.nav('boxes')">üéÅ CAJAS MISTERIOSAS</div>
        <div class="nav-item" onclick="core.nav('inventory')">üéí INVENTARIO</div>
        <div class="nav-item" onclick="core.nav('trades')">ü§ù TRADEOS</div>
        <div class="nav-item" onclick="core.nav('shop')">üí∞ COMPRAR TOKENS</div>
        <div id="adm-link" class="nav-item" style="display:none; color:var(--accent)" onclick="core.nav('admin')">üõ† ADMIN</div>
        <div class="nav-item" style="color:var(--red); margin-top:auto" onclick="location.reload()">üö™ SALIR</div>
    </nav>
</aside>

<main class="main">
    <div id="v-lobby" class="view active">
        <h1 style="font-family:'Orbitron';">EL <span style="color:var(--accent)">IMPERIO</span> TE ESPERA</h1>
        <div class="glass">
            <h3>Novedades 2026</h3>
            <p>Sistema de tradeo entre jugadores activo. Reclama tus items al correo oficial.</p>
        </div>
    </div>

    <div id="v-games" class="view">
        <h1>SALA DE JUEGOS</h1>
        <div class="grid-games" id="games-list">
            </div>
    </div>

    <div id="v-boxes" class="view">
        <h1>CAJAS MISTERIOSAS</h1>
        <div class="grid-games" id="boxes-list"></div>
    </div>

    <div id="v-inventory" class="view">
        <h1>MI INVENTARIO</h1>
        <div id="inv-list"></div>
    </div>

    <div id="v-trades" class="view">
        <h1>SISTEMA DE TRADEO</h1>
        <div class="glass">
            <input type="text" id="trade-user" placeholder="Nombre del otro jugador">
            <button class="btn" onclick="core.createTrade()">INICIAR INTERCAMBIO</button>
        </div>
        <div id="pending-trades" style="margin-top:20px;"></div>
    </div>

    <div id="v-shop" class="view">
        <h1>TIENDA DE TOKENS (1 USD = 10 ü™ô)</h1>
        <div id="paypal-button-container"></div>
    </div>

    <div id="v-admin" class="view">
        <h1>PANEL MAESTRO</h1>
        <div class="glass">
            <h3>Configurar Cajas</h3>
            <input type="text" id="box-name" placeholder="Nombre de la Caja">
            <input type="text" id="box-items" placeholder="Items (separados por coma)">
            <input type="number" id="box-price" placeholder="Precio en Tokens">
            <button class="btn" onclick="core.addBox()">A√ëADIR CAJA</button>
        </div>
    </div>
</main>

<script>
// CONFIGURACI√ìN Y L√ìGICA CORE
const core = {
    db: JSON.parse(localStorage.getItem('smal_db_v12')) || {
        users: [{u:'maestro', p:'Elite2026', bal:99999, inv:[], admin:true}],
        boxes: [{name: 'Caja Inicial', price: 100, items: ['Reloj de Oro', 'Skins VIP', 'Token x500']}],
        trades: []
    },
    currentUser: null,
    
    save() { localStorage.setItem('smal_db_v12', JSON.stringify(this.db)); this.updateUI(); },

    handleAuth(type) {
        const u = document.getElementById('log-user').value.toLowerCase();
        const p = document.getElementById('log-pass').value;
        if(!u || !p) return;

        let user = this.db.users.find(x => x.u === u);
        if(type === 'login') {
            if(user && user.p === p) this.startSession(user);
            else alert("Datos incorrectos");
        } else {
            if(user) return alert("Usuario ya existe");
            user = {u, p, bal:50, inv:[], admin:false};
            this.db.users.push(user); this.save(); this.startSession(user);
        }
    },

    startSession(user) {
        this.currentUser = user;
        document.getElementById('auth-screen').style.display = 'none';
        if(user.admin) document.getElementById('adm-link').style.display = 'flex';
        this.nav('lobby');
        this.renderGames();
        this.renderBoxes();
        this.updateUI();
    },

    nav(id) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById('v-' + id).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        if(id === 'inventory') this.renderInventory();
    },

    updateUI() {
        if(!this.currentUser) return;
        document.getElementById('u-name').innerText = this.currentUser.u.toUpperCase();
        document.getElementById('u-bal').innerText = Math.floor(this.currentUser.bal);
        document.getElementById('u-ava').innerText = this.currentUser.u[0].toUpperCase();
    },

    // --- SISTEMA DE 10 JUEGOS ---
    renderGames() {
        const games = [
            {n: 'Slots', cost: 10}, {n: 'Ruleta', cost: 20}, {n: 'Minas', cost: 15},
            {n: 'Crash', cost: 25}, {n: 'Dados', cost: 10}, {n: 'Cartas', cost: 30},
            {n: 'Plinko', cost: 15}, {n: 'Torre', cost: 20}, {n: 'Rueda', cost: 10}, {n: 'Blackjack', cost: 50}
        ];
        const container = document.getElementById('games-list');
        container.innerHTML = games.map(g => `
            <div class="glass box-card">
                <h3>${g.n}</h3>
                <p>Costo: ${g.cost} ü™ô</p>
                <button class="btn" onclick="core.playGame('${g.n}', ${g.cost})">JUGAR</button>
            </div>
        `).join('');
    },

    playGame(name, cost) {
        if(this.currentUser.bal < cost) return alert("Tokens insuficientes");
        this.currentUser.bal -= cost;
        const win = Math.random() > 0.6 ? cost * 2.5 : 0;
        if(win > 0) {
            this.currentUser.bal += win;
            confetti();
            alert(`¬°Ganaste ${win} tokens en ${name}!`);
        } else {
            alert(`Perdiste en ${name}. ¬°Suerte la pr√≥xima!`);
        }
        this.save();
    },

    // --- SISTEMA DE CAJAS ---
    renderBoxes() {
        const container = document.getElementById('boxes-list');
        container.innerHTML = this.db.boxes.map((b, i) => `
            <div class="glass box-card">
                <h3>${b.name}</h3>
                <p>Precio: ${b.price} ü™ô</p>
                <button class="btn btn-gold" onclick="core.openBox(${i})">ABRIR</button>
            </div>
        `).join('');
    },

    openBox(index) {
        const box = this.db.boxes[index];
        if(this.currentUser.bal < box.price) return alert("No tienes tokens");
        this.currentUser.bal -= box.price;
        const item = box.items[Math.floor(Math.random() * box.items.length)];
        this.currentUser.inv.push({id: Date.now(), name: item});
        alert(`¬°Te sali√≥: ${item}! Guardado en inventario.`);
        this.save();
    },

    // --- INVENTARIO Y RECLAMO ---
    renderInventory() {
        const container = document.getElementById('inv-list');
        container.innerHTML = this.currentUser.inv.length ? '' : '<p>Vacio</p>';
        this.currentUser.inv.forEach((it, idx) => {
            container.innerHTML += `
                <div class="item-card">
                    <span>${it.name}</span>
                    <div>
                        <button class="btn" style="width:auto; padding:5px 10px; background:var(--gold);" onclick="core.claimItem(${it.id})">RECLAMAR</button>
                        <button class="btn" style="width:auto; padding:5px 10px; background:var(--red);" onclick="core.sellItem(${idx})">VENDER</button>
                    </div>
                </div>
            `;
        });
    },

    claimItem(id) {
        const item = this.currentUser.inv.find(x => x.id === id);
        const subject = encodeURIComponent(`RECLAMO DE ITEM: ${item.name}`);
        const body = encodeURIComponent(`El usuario ${this.currentUser.u} quiere reclamar su ${item.name}. Por favor enviarlo.`);
        window.open(`mailto:gancinomaikel@gmail.com?subject=${subject}&body=${body}`);
        this.currentUser.inv = this.currentUser.inv.filter(x => x.id !== id);
        this.save();
        this.renderInventory();
    },

    sellItem(idx) {
        this.currentUser.bal += 50; // Precio fijo de venta
        this.currentUser.inv.splice(idx, 1);
        this.save();
        this.renderInventory();
    },

    // --- TIENDA PAYPAL ---
    initPaypal() {
        paypal.Buttons({
            createOrder: (data, actions) => {
                return actions.order.create({
                    purchase_units: [{ amount: { value: '10.00' } }] // Ejemplo 10 USD
                });
            },
            onApprove: (data, actions) => {
                return actions.order.capture().then(details => {
                    this.currentUser.bal += 100; // 10 USD = 100 Tokens
                    this.save();
                    alert('¬°Compra exitosa! Se a√±adieron 100 tokens.');
                });
            }
        }).render('#paypal-button-container');
    }
};

// Inicializar tienda
setTimeout(() => core.initPaypal(), 2000);
</script>
</body>
</html>
