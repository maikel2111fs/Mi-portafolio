<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMAL EMPIRE | ELITE CASINO</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --bg: #0b0e11; --card: #1a1d23; --accent: #00ff59; --gold: #ffc107;
            --text: #ffffff; --text-dim: #848e9c; --border: #2b2f36; --red: #ff3b3b;
        }
        * { box-sizing: border-box; font-family: 'Inter', sans-serif; transition: 0.2s; }
        body { background: var(--bg); color: var(--text); margin: 0; display: flex; height: 100vh; overflow: hidden; }

        /* --- SIDEBAR PRO --- */
        .sidebar { width: 260px; background: var(--card); border-right: 1px solid var(--border); display: flex; flex-direction: column; }
        .nav-item { padding: 14px 20px; cursor: pointer; color: var(--text-dim); display: flex; align-items: center; gap: 12px; font-weight: 600; font-size: 0.9rem; }
        .nav-item:hover, .nav-item.active { background: #2b2f36; color: var(--accent); }
        .balance-box { background: #0b0e11; margin: 20px; padding: 15px; border-radius: 12px; border: 1px solid var(--border); text-align: center; }

        /* --- MAIN AREA --- */
        .main { flex: 1; overflow-y: auto; padding: 25px; position: relative; }
        .view { display: none; } .view.active { display: block; }

        /* --- CARDS & GRID --- */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }
        .game-card { background: var(--card); border-radius: 15px; padding: 20px; border: 1px solid var(--border); cursor: pointer; text-align: center; position: relative; overflow: hidden; }
        .game-card:hover { border-color: var(--accent); transform: translateY(-5px); }
        .game-card h3 { margin: 10px 0 5px; font-family: 'Orbitron'; font-size: 0.9rem; }

        /* --- LIVE FEED (Falso) --- */
        .live-feed { height: 40px; background: rgba(0,0,0,0.3); border-radius: 10px; margin-bottom: 20px; display: flex; align-items: center; padding: 0 15px; overflow: hidden; font-size: 0.8rem; border: 1px solid var(--border); }
        .feed-track { display: flex; gap: 30px; animation: scrollText 20s linear infinite; white-space: nowrap; }
        @keyframes scrollText { from { transform: translateX(100%); } to { transform: translateX(-100%); } }

        /* --- GAME ENGINE UI --- */
        .engine-container { max-width: 800px; margin: 0 auto; background: var(--card); border-radius: 20px; border: 1px solid var(--accent); overflow: hidden; display: flex; flex-direction: column; }
        .game-header { padding: 15px; background: #2b2f36; display: flex; justify-content: space-between; align-items: center; }
        .game-body { padding: 40px; display: flex; flex-direction: column; align-items: center; min-height: 400px; justify-content: center; }
        .bet-input { background: #0b0e11; border: 1px solid var(--border); color: white; padding: 12px; border-radius: 8px; width: 150px; text-align: center; font-weight: 800; }
        .btn-play { background: var(--accent); color: black; border: none; padding: 15px 40px; border-radius: 8px; font-weight: 900; cursor: pointer; margin-top: 15px; width: 200px; }
        .btn-play:disabled { opacity: 0.5; cursor: not-allowed; }

        /* --- AUTH --- */
        #auth-screen { position: fixed; inset: 0; background: var(--bg); z-index: 1000; display: flex; align-items: center; justify-content: center; }
        .auth-card { background: var(--card); padding: 40px; border-radius: 20px; width: 350px; text-align: center; border: 1px solid var(--accent); }

        /* --- TABLES --- */
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { text-align: left; color: var(--text-dim); padding: 10px; border-bottom: 1px solid var(--border); }
        td { padding: 15px 10px; border-bottom: 1px solid var(--border); }
        .rank-gold { color: var(--gold); font-weight: 800; }

        /* --- TRADES & AMIGOS --- */
        .trade-box { background: #2b2f36; padding: 15px; border-radius: 10px; margin-bottom: 10px; }
    </style>
</head>
<body>

<div id="auth-screen">
    <div class="auth-card">
        <h1 style="font-family:'Orbitron'; color:var(--accent); margin-bottom:0;">SMAL EMPIRE</h1>
        <p style="color:var(--text-dim); margin-bottom:30px;">V3 BLACK EDITION</p>
        <input type="text" id="user-in" placeholder="Usuario" style="width:100%; padding:12px; margin-bottom:10px; background:#0b0e11; border:1px solid var(--border); color:white; border-radius:8px;">
        <button class="btn-play" style="width:100%" onclick="login()">ENTRAR AL IMPERIO</button>
    </div>
</div>

<aside class="sidebar">
    <div style="padding: 25px; text-align: center;">
        <div id="u-ava" style="width:60px; height:60px; background:var(--accent); border-radius:50%; margin: 0 auto 10px; display:flex; align-items:center; justify-content:center; color:black; font-weight:900; font-size:1.5rem;">?</div>
        <h3 id="u-name" style="margin:0;">Invitado</h3>
    </div>
    <div class="balance-box">
        <div style="font-size:0.7rem; color:var(--text-dim);">TU SALDO</div>
        <div style="font-size:1.4rem; font-weight:900; color:var(--gold);">ü™ô <span id="u-bal">0.00</span></div>
        <div id="u-free" style="font-size:0.65rem; color:var(--accent); margin-top:5px;">3 TIRADAS GRATIS RESTANTES</div>
    </div>
    <nav>
        <div class="nav-item active" onclick="showV('home')">üè† Lobby</div>
        <div class="nav-item" onclick="showV('games')">üéÆ Juegos Elite</div>
        <div class="nav-item" onclick="showV('leader')">üèÜ Tabla de L√≠deres</div>
        <div class="nav-item" onclick="showV('social')">ü§ù Amigos & Trade</div>
        <div class="nav-item" onclick="showV('inv')">üéí Mi Mochila</div>
        <div class="nav-item" id="adm-link" style="display:none; color:var(--gold)" onclick="showV('admin')">üõ† PANEL MAESTRO</div>
    </nav>
</aside>

<main class="main">
    <div class="live-feed">
        <div class="feed-track" id="live-wins">
            </div>
    </div>

    <div id="v-home" class="view active">
        <h1 style="font-family:'Orbitron'; font-size:2rem;">BIENVENIDO, <span id="hi-name" style="color:var(--accent)">JEFE</span></h1>
        <div class="grid">
            <div class="game-card" onclick="showV('games')"><h3>SALA DE JUEGOS</h3><p>10 juegos multiplicadores</p></div>
            <div class="game-card" onclick="showV('social')"><h3>SISTEMA SOCIAL</h3><p>Agrega amigos y haz trades</p></div>
        </div>
    </div>

    <div id="v-games" class="view">
        <div id="game-selection" class="grid">
            <div class="game-card" onclick="loadGame('MINAS')">üí£<h3>MINAS</h3></div>
            <div class="game-card" onclick="loadGame('CRASH')">üöÄ<h3>CRASH</h3></div>
            <div class="game-card" onclick="loadGame('COIN')">ü™ô<h3>MONEDA</h3></div>
            <div class="game-card" onclick="loadGame('SLOTS')">üé∞<h3>SLOTS</h3></div>
            <div class="game-card" onclick="loadGame('DADOS')">üé≤<h3>DADOS</h3></div>
            <div class="game-card" onclick="loadGame('PLINKO')">üîµ<h3>PLINKO</h3></div>
            <div class="game-card" onclick="loadGame('RUEDA')">üé°<h3>RUEDA</h3></div>
            <div class="game-card" onclick="loadGame('TOWER')">üóº<h3>TORRE</h3></div>
            <div class="game-card" onclick="loadGame('BJ')">üÉè<h3>BJ 21</h3></div>
            <div class="game-card" onclick="loadGame('BOXES')">üì¶<h3>CAJAS</h3></div>
        </div>

        <div id="game-engine" class="engine-container" style="display:none">
            <div class="game-header">
                <span id="g-title" style="font-family:'Orbitron'; font-weight:900;">JUEGO</span>
                <button onclick="exitGame()" style="background:none; border:none; color:white; cursor:pointer;">‚ùå</button>
            </div>
            <div class="game-body">
                <div id="g-display" style="margin-bottom:30px;"></div>
                <div style="display:flex; gap:10px; align-items:center;">
                    <input type="number" id="bet-amt" class="bet-input" value="10">
                    <button class="btn-play" id="btn-start" onclick="playGame()">APOSTAR</button>
                    <button class="btn-play" id="btn-cash" style="display:none; background:var(--gold)" onclick="cashout()">RETIRAR</button>
                </div>
                <p id="g-msg" style="margin-top:20px; font-weight:800;"></p>
            </div>
        </div>
    </div>

    <div id="v-leader" class="view">
        <h1>üèÜ TOP MUNDIAL IMPERIO</h1>
        <table id="leader-table">
            <thead><tr><th>RANGO</th><th>USUARIO</th><th>GANANCIAS</th></tr></thead>
            <tbody></tbody>
        </table>
    </div>

    <div id="v-social" class="view">
        <h1>ü§ù SISTEMA SOCIAL</h1>
        <div class="grid">
            <div class="game-card">
                <h3>AGREGAR AMIGO</h3>
                <input type="text" id="friend-name" placeholder="Nombre de usuario" style="width:100%; padding:10px; margin-top:10px; background:#0b0e11; border:1px solid var(--border); color:white; border-radius:5px;">
                <button class="btn-play" style="width:100%;" onclick="addFriend()">ENVIAR SOLICITUD</button>
            </div>
            <div class="game-card">
                <h3>ENV√çO DE TOKENS (TRADE)</h3>
                <input type="text" id="trade-user" placeholder="A qui√©n env√≠a">
                <input type="number" id="trade-amt" placeholder="Cantidad">
                <button class="btn-play" style="width:100%; background:var(--gold)" onclick="sendTrade()">ENVIAR REGALO</button>
            </div>
        </div>
        <h3 style="margin-top:40px;">LISTA DE AMIGOS</h3>
        <div id="friend-list"></div>
    </div>

    <div id="v-inv" class="view">
        <h1>üéí MI MOCHILA</h1>
        <div class="grid" id="inv-grid"></div>
    </div>

    <div id="v-admin" class="view">
        <h1>üõ† CONTROL MAESTRO</h1>
        <div class="grid">
            <div class="game-card">
                <h3>DAR TOKENS</h3>
                <input type="number" id="adm-amt" placeholder="Cantidad">
                <button class="btn-play" onclick="admAdd()">SUMAR A MI SALDO</button>
            </div>
        </div>
    </div>
</main>

<script>
    // --- ESTADO Y PERSISTENCIA ---
    let state = JSON.parse(localStorage.getItem('smal_v3_save')) || {
        u: "", bal: 0, free: 3, inv: [], friends: [], 
        leaderboard: [
            {n: "SmalAdmin", b: 15000}, {n: "Rey_Crypto", b: 8500}, {n: "DarkSoul", b: 4200}
        ]
    };

    function save() { localStorage.setItem('smal_v3_save', JSON.stringify(state)); }

    function login() {
        let user = document.getElementById('user-in').value;
        if(!user) return;
        state.u = user;
        if(user === "SmalAdmin") document.getElementById('adm-link').style.display = 'flex';
        document.getElementById('auth-screen').style.display = 'none';
        document.getElementById('u-name').innerText = user;
        document.getElementById('hi-name').innerText = user;
        document.getElementById('u-ava').innerText = user[0].toUpperCase();
        refreshUI();
        initLiveFeed();
    }

    function refreshUI() {
        document.getElementById('u-bal').innerText = state.bal.toFixed(2);
        document.getElementById('u-free').innerText = state.free > 0 ? `${state.free} TIRADAS GRATIS RESTANTES` : "MODO REAL ACTIVO";
        renderLeaders();
        renderInv();
        renderFriends();
        save();
    }

    function showV(id) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById('v-' + id).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
    }

    // --- LIVE FEED FALSO ---
    function initLiveFeed() {
        const feed = document.getElementById('live-wins');
        const names = ["User99", "Dragon", "Player_X", "SmalFan", "Tito", "EcuadorKing"];
        const games = ["Minas", "Crash", "Slots", "BJ"];
        
        setInterval(() => {
            let n = names[Math.floor(Math.random()*names.length)];
            let g = games[Math.floor(Math.random()*games.length)];
            let w = (Math.random()*100).toFixed(2);
            let item = document.createElement('span');
            item.innerHTML = `üü¢ <b>${n}</b> gan√≥ ü™ô${w} en <b>${g}</b>`;
            feed.appendChild(item);
            if(feed.children.length > 10) feed.removeChild(feed.firstChild);
        }, 3000);
    }

    // --- MOTOR DE JUEGOS ---
    let currentG = null;
    let multiplier = 1.0;
    let activeBet = 0;

    function loadGame(game) {
        currentG = game;
        document.getElementById('game-selection').style.display = 'none';
        document.getElementById('game-engine').style.display = 'flex';
        document.getElementById('g-title').innerText = game;
        document.getElementById('g-msg').innerText = "Introduce apuesta y dale a jugar";
        resetGameView();
    }

    function resetGameView() {
        const display = document.getElementById('g-display');
        display.innerHTML = "";
        if(currentG === 'MINAS') {
            display.innerHTML = `<div style="display:grid; grid-template-columns:repeat(3, 60px); gap:10px;" id="m-grid">
                ${Array(9).fill('<div style="width:60px; height:60px; background:#0b0e11; border-radius:10px; display:flex; align-items:center; justify-content:center; cursor:pointer;" onclick="stepMinas(this)">?</div>').join('')}
            </div>`;
        } else if(currentG === 'CRASH') {
            display.innerHTML = `<div id="crash-v" style="font-size:4rem; font-family:'Orbitron'; color:var(--accent);">1.00x</div>`;
        } else {
            display.innerHTML = `<div style="font-size:3rem;">üé∞</div>`;
        }
    }

    function playGame() {
        let bet = parseFloat(document.getElementById('bet-amt').value);
        if(state.free <= 0 && state.bal < bet) return alert("Saldo insuficiente");

        if(state.free > 0) {
            state.free--;
        } else {
            state.bal -= bet;
        }

        activeBet = bet;
        multiplier = 1.0;
        document.getElementById('btn-start').disabled = true;
        refreshUI();

        if(currentG === 'CRASH') startCrash();
        else if(currentG === 'MINAS') document.getElementById('g-msg').innerText = "Busca los diamantes...";
        else playQuick();
    }

    // --- LOGICA CRASH ---
    let crashInterval;
    function startCrash() {
        document.getElementById('btn-cash').style.display = "block";
        let crashPoint = (Math.random() * 4) + 1.1;
        crashInterval = setInterval(() => {
            multiplier += 0.05;
            document.getElementById('crash-v').innerText = multiplier.toFixed(2) + "x";
            if(multiplier >= crashPoint) {
                clearInterval(crashInterval);
                document.getElementById('crash-v').style.color = "var(--red)";
                document.getElementById('g-msg').innerText = "¬°CRASHED! Perdiste la apuesta.";
                setTimeout(exitGame, 2000);
            }
        }, 100);
    }

    function cashout() {
        clearInterval(crashInterval);
        let win = activeBet * multiplier;
        state.bal += win;
        confetti();
        alert("¬°Cobraste " + win.toFixed(2) + " Tokens!");
        exitGame();
        refreshUI();
    }

    // --- LOGICA MINAS ---
    let minesInGame = [0,0,1]; // 1 es bomba
    function stepMinas(el) {
        if(el.innerText !== "?") return;
        let isBomb = Math.random() > 0.7;
        if(isBomb) {
            el.innerHTML = "üí£"; el.style.background = "var(--red)";
            alert("BOOM! Perdiste.");
            exitGame();
        } else {
            el.innerHTML = "üíé"; el.style.background = "var(--accent)";
            multiplier += 0.5;
            document.getElementById('btn-cash').style.display = "block";
            document.getElementById('btn-cash').innerText = `RETIRAR (${(activeBet * multiplier).toFixed(2)})`;
        }
    }

    function playQuick() {
        let win = Math.random() > 0.6;
        if(win) {
            state.bal += activeBet * 2;
            confetti();
            document.getElementById('g-msg').innerText = "¬°GANASTE EL DOBLE!";
        } else {
            document.getElementById('g-msg').innerText = "Perdiste. Sigue intentando.";
        }
        setTimeout(exitGame, 2000);
        refreshUI();
    }

    function exitGame() {
        clearInterval(crashInterval);
        document.getElementById('game-selection').style.display = 'grid';
        document.getElementById('game-engine').style.display = 'none';
        document.getElementById('btn-start').disabled = false;
        document.getElementById('btn-cash').style.display = "none";
        document.getElementById('btn-cash').innerText = "RETIRAR";
    }

    // --- SOCIAL ---
    function addFriend() {
        let f = document.getElementById('friend-name').value;
        if(f) {
            state.friends.push(f);
            alert("Solicitud enviada a " + f);
            refreshUI();
        }
    }

    function sendTrade() {
        let u = document.getElementById('trade-user').value;
        let a = parseFloat(document.getElementById('trade-amt').value);
        if(state.bal >= a) {
            state.bal -= a;
            alert(`Enviaste ü™ô${a} a ${u} correctamente.`);
            refreshUI();
        } else { alert("Saldo insuficiente"); }
    }

    function renderFriends() {
        const c = document.getElementById('friend-list');
        c.innerHTML = "";
        state.friends.forEach(f => {
            c.innerHTML += `<div class="trade-box">üë§ ${f} <span style="color:var(--accent); font-size:0.7rem;">‚Ä¢ EN L√çNEA</span></div>`;
        });
    }

    // --- LIDERES ---
    function renderLeaders() {
        const tbody = document.querySelector('#leader-table tbody');
        tbody.innerHTML = "";
        state.leaderboard.sort((a,b) => b.b - a.b).forEach((u, i) => {
            tbody.innerHTML += `<tr><td>#${i+1}</td><td class="${i===0?'rank-gold':''}">${u.n}</td><td>ü™ô ${u.b}</td></tr>`;
        });
    }

    // --- ADMIN ---
    function admAdd() {
        let a = parseFloat(document.getElementById('adm-amt').value);
        state.bal += a;
        refreshUI();
    }

    function renderInv() {
        const c = document.getElementById('inv-grid');
        c.innerHTML = state.inv.length === 0 ? "Vac√≠o" : "";
        state.inv.forEach((item, idx) => {
            c.innerHTML += `<div class="game-card"><h3>${item}</h3><button class="btn-play" style="width:100%" onclick="claim('${item}', ${idx})">RECLAMAR</button></div>`;
        });
    }

    function claim(item, idx) {
        window.open(`https://wa.me/593987749885?text=RECLAMO PREMIO: ${item}`);
        state.inv.splice(idx, 1);
        refreshUI();
    }

</script>
</body>
</html>
